subproblem algorithm
TO DO:
	- reduce allocations
