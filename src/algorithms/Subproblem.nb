(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 13.2' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     81501,       1674]
NotebookOptionsPosition[     78007,       1611]
NotebookOutlinePosition[     78410,       1627]
CellTagsIndexPosition[     78367,       1624]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell[BoxData[
 RowBox[{"NotebookDirectory", "[", "]"}]], "Input",
 CellChangeTimes->{{3.9445819290941925`*^9, 3.9445819376085052`*^9}},
 CellLabel->"In[2]:=",ExpressionUUID->"927a0af1-6d07-4841-a4de-3ec128879900"],

Cell[BoxData["\<\"/home/mr/job-related/MyOptimizationAlg/src/algorithms/\"\>"]\
, "Output",
 CellChangeTimes->{{3.9445819348847747`*^9, 3.944581938156715*^9}, 
   3.9445823860043507`*^9, 3.944585608471959*^9, 3.944752596943486*^9, 
   3.946482353610509*^9, 3.946485652539456*^9, 3.946486313030821*^9, 
   3.94654679578878*^9},
 CellLabel->"Out[2]=",ExpressionUUID->"fc3499e5-9f96-4a51-956a-ccf309f64150"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"SetDirectory", "[", 
  RowBox[{"NotebookDirectory", "[", "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.9445819109188366`*^9, 3.9445819443001957`*^9}},
 CellLabel->"In[3]:=",ExpressionUUID->"7c76c145-1f51-40ec-87db-d42ea99550cc"],

Cell[BoxData["\<\"/home/mr/job-related/MyOptimizationAlg/src/algorithms\"\>"],\
 "Output",
 CellChangeTimes->{{3.944581915091589*^9, 3.9445819455427876`*^9}, 
   3.944582387042471*^9, 3.944585610036294*^9, 3.944752598330326*^9, 
   3.946482357691633*^9, 3.946485657568273*^9, 3.9464863178100777`*^9, 
   3.9465467970987997`*^9},
 CellLabel->"Out[3]=",ExpressionUUID->"bdb8f08d-00f1-47cc-9784-2030c28daa65"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Lagrangian for bound constraints", "Subsubsection",
 CellChangeTimes->{{3.9466207755884237`*^9, 3.946620801768663*^9}, {
  3.9466226266418047`*^9, 
  3.9466226492232018`*^9}},ExpressionUUID->"5af5aef7-6e4f-4ee3-b3dc-\
cd5bcaee2ee4"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"LgrFun", "[", 
    RowBox[{"x_", ",", "\[Lambda]_", ",", "lb_", ",", "penalty_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"diff", ",", " ", "term", ",", "functional"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"diff", "\[DoubleRightTee]", 
       RowBox[{"x", "-", "lb"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"term", "\[DoubleRightTee]", 
       RowBox[{"\[Lambda]", "+", 
        RowBox[{"penalty", "*", "diff"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"functional", " ", "\[RightTee]", " ", 
       RowBox[{"Total", "[", 
        RowBox[{"Table", "[", " ", 
         RowBox[{
          RowBox[{"SMSIf", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"term", "[", 
              RowBox[{"[", "i", "]"}], "]"}], "<", "0"}], ",", 
            RowBox[{
             RowBox[{
              RowBox[{"\[Lambda]", "[", 
               RowBox[{"[", "i", "]"}], "]"}], "*", 
              RowBox[{"diff", "[", 
               RowBox[{"[", "i", "]"}], "]"}]}], "+", 
             RowBox[{"0.5", "*", "penalty", "*", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"diff", "[", 
                 RowBox[{"[", "i", "]"}], "]"}], ")"}], "^", "2"}]}]}], ",", 
            "0"}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", 
            RowBox[{"Length", "[", "x", "]"}]}], "}"}]}], "]"}], "]"}]}], ";",
       "\[IndentingNewLine]", "functional"}]}], "\[IndentingNewLine]", 
    "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.9466226535949163`*^9, 3.9466227423508377`*^9}, {
  3.946622773855197*^9, 3.946622873014694*^9}, {3.946623027742505*^9, 
  3.9466231096252623`*^9}, {3.946623340774308*^9, 3.946623348710553*^9}, {
  3.946623398861711*^9, 3.946623399470059*^9}, {3.9466234973541307`*^9, 
  3.946623512958301*^9}, {3.946623961793432*^9, 3.9466239645606813`*^9}, {
  3.946624106025826*^9, 3.946624115824712*^9}, {3.946651019693398*^9, 
  3.946651073064603*^9}},
 CellLabel->
  "In[393]:=",ExpressionUUID->"b76dce2c-179c-41ac-9cdf-9703c9eb6d1b"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"LgrGrad", "[", 
    RowBox[{"x_", ",", "\[Lambda]_", ",", "lb_", ",", "penalty_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"diff", ",", " ", "term", ",", "gradient"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"diff", "\[DoubleRightTee]", 
       RowBox[{"x", "-", "lb"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"term", "\[DoubleRightTee]", 
       RowBox[{"\[Lambda]", "+", 
        RowBox[{"penalty", "*", "diff"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"gradient", " ", "\[RightTee]", " ", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"SMSIf", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"term", "[", 
             RowBox[{"[", "i", "]"}], "]"}], "<", "0"}], ",", 
           RowBox[{"term", "[", 
            RowBox[{"[", "i", "]"}], "]"}], ",", "0"}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", 
           RowBox[{"Length", "[", "x", "]"}]}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", "gradient"}]}], "\[IndentingNewLine]", "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.946623411910129*^9, 3.946623413661983*^9}, {
   3.9466235853974657`*^9, 3.946623628574038*^9}, 3.9466510311307383`*^9, {
   3.9466510879860764`*^9, 3.94665109499104*^9}},
 CellLabel->
  "In[394]:=",ExpressionUUID->"9d09b268-7081-4bd4-a59f-dc34772c3b59"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"LgrHess", "[", 
    RowBox[{"x_", ",", "\[Lambda]_", ",", "lb_", ",", "penalty_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"diff", ",", " ", "term", ",", "hessian"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"diff", "\[DoubleRightTee]", 
       RowBox[{"x", "-", "lb"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"term", "\[DoubleRightTee]", 
       RowBox[{"\[Lambda]", "+", 
        RowBox[{"penalty", "*", "diff"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"hessian", "\[RightTee]", " ", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"SMSIf", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"term", "[", 
             RowBox[{"[", "i", "]"}], "]"}], "<", "0"}], ",", "penalty", ",", 
           "0"}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", 
           RowBox[{"Length", "[", "x", "]"}]}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"DiagonalMatrix", "[", "hessian", "]"}]}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.946624214192939*^9, 3.946624292088435*^9}, {
   3.9466243465139723`*^9, 3.946624347163026*^9}, 3.9466510357459517`*^9, {
   3.946651153947166*^9, 3.946651170559533*^9}},
 CellLabel->
  "In[395]:=",ExpressionUUID->"9af1e659-a6ce-408f-99b8-50d46e96b2c3"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"LgrUpdate", "[", 
    RowBox[{"x_", ",", "\[Lambda]_", ",", "lb_", ",", "penalty_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"diff", ",", "term", ",", "\[Lambda]upadate"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"diff", "\[DoubleRightTee]", 
       RowBox[{"x", "-", "lb"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"term", "\[DoubleRightTee]", 
       RowBox[{"\[Lambda]", "+", 
        RowBox[{"penalty", "*", "diff"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"\[Lambda]upadate", "\[RightTee]", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"SMSIf", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"term", "[", 
             RowBox[{"[", "i", "]"}], "]"}], "<", "0"}], ",", 
           RowBox[{
            RowBox[{"\[Lambda]", "[", 
             RowBox[{"[", "i", "]"}], "]"}], "+", 
            RowBox[{"penalty", "*", 
             RowBox[{"diff", "[", 
              RowBox[{"[", "i", "]"}], "]"}]}]}], ",", "0"}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", 
           RowBox[{"Length", "[", "x", "]"}]}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\[Lambda]upadate"}]}], "\[IndentingNewLine]", 
    "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.9466489523209133`*^9, 3.9466489669498034`*^9}, {
   3.9466490126455727`*^9, 3.946649259565353*^9}, {3.9466511781434526`*^9, 
   3.946651190386579*^9}, {3.946651326536035*^9, 3.946651351351672*^9}, 
   3.946651458991428*^9, {3.9466515250659027`*^9, 3.946651542544373*^9}, {
   3.946654743202567*^9, 3.946654745961624*^9}, {3.946654844066559*^9, 
   3.946654872033799*^9}},
 CellLabel->
  "In[396]:=",ExpressionUUID->"de2bd003-32bb-493b-b4a0-2420c3688d6b"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"ConstraintsViolation", "[", 
    RowBox[{"x_", ",", "\[Lambda]_", ",", "lb_", ",", "penalty_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"diff", ",", "cnstr"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"diff", "\[DoubleRightTee]", 
       RowBox[{"x", "-", "lb"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"cnstr", "\[RightTee]", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"SMSIf", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"x", "[", 
             RowBox[{"[", "i", "]"}], "]"}], "<", 
            RowBox[{"lb", "[", 
             RowBox[{"[", "i", "]"}], "]"}]}], ",", 
           RowBox[{"diff", "[", 
            RowBox[{"[", "i", "]"}], "]"}], ",", "0"}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", 
           RowBox[{"Length", "[", "x", "]"}]}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", "cnstr"}]}], "\[IndentingNewLine]", "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.9466493576693687`*^9, 3.946649367237132*^9}, {
   3.9466494430137978`*^9, 3.946649468765321*^9}, {3.946649559909646*^9, 
   3.9466495658448143`*^9}, 3.946651484767322*^9, {3.946651550079401*^9, 
   3.9466515729270897`*^9}},
 CellLabel->
  "In[397]:=",ExpressionUUID->"cebd3a71-bb0c-4cf5-9cba-3fddca3243f9"]
}, Closed]],

Cell[CellGroupData[{

Cell["Trust Region algorithm", "Subsubsection",
 CellChangeTimes->{{3.9466207755884237`*^9, 
  3.946620801768663*^9}},ExpressionUUID->"e80f8db0-b2b1-4e23-a1f9-\
bc6824d22812"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"TrustRegion", "[", 
     RowBox[{
     "fun_", ",", "grad_", ",", "hess_", ",", "deltaIn_", ",", "x0_", ",", 
      "verbose_"}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "sol", ",", "solInner", ",", "solTry", ",", "hessVal", ",", "gradVal", 
        ",", "funcVal", ",", "numerator", ",", "denominator", ",", "rho", ",",
         "fTry", ",", "delta"}], "}"}], ",", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"hessVal", "\[DoubleLeftTee]", 
        RowBox[{"hess", "[", "x0", "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"gradVal", "\[DoubleLeftTee]", 
        RowBox[{"grad", "[", "x0", "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"funcVal", "\[DoubleLeftTee]", 
        RowBox[{"fun", "[", "x0", "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"sol", "\[DoubleLeftTee]", "x0"}], ";", "\[IndentingNewLine]", 
       RowBox[{"delta", "\[DoubleLeftTee]", "deltaIn"}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"SMSDo", "[", 
        RowBox[{"i", ",", "1", ",", "10000", ",", "1", ",", 
         RowBox[{"{", 
          RowBox[{
          "hessVal", ",", "gradVal", ",", "funcVal", ",", "sol", ",", 
           "delta"}], "}"}]}], "]"}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"verbose", ">", "1"}], ",", 
         RowBox[{"SMSPrint", "[", 
          RowBox[{
          "\"\<Iteration = \>\"", ",", "i", ",", "\"\<  Delta = \>\"", ",", 
           "delta", ",", " ", 
           RowBox[{"\"\<Optimal\>\"", "->", "True"}]}], "]"}]}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{"Call", " ", "Subproblem", " ", "Solver", " ", 
         RowBox[{"(", 
          RowBox[{"Assume", " ", 
           RowBox[{"it", "'"}], "s", " ", "a", " ", "separate", " ", 
           "function"}], ")"}]}], "*)"}], "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"subproblemC", "=", 
        RowBox[{"SMSCall", "[", 
         RowBox[{"\"\<subproblem\>\"", ",", "hessVal", ",", "gradVal", ",", 
          RowBox[{"Real", "[", 
           RowBox[{"sol$$", "[", "n", "]"}], "]"}], ",", "delta", ",", 
          RowBox[{"\"\<System\>\"", "->", "False"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"solInner", "\[DoubleRightTee]", 
        RowBox[{"SMSReal", "[", 
         RowBox[{
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"sol$$", "[", "si", "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"si", ",", "n"}], "}"}]}], "]"}], ",", 
          RowBox[{"\"\<Subordinate\>\"", "\[Rule]", "subproblemC"}]}], 
         "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"solTry", "\[DoubleRightTee]", 
        RowBox[{"sol", "+", "solInner"}]}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"fTry", "\[DoubleRightTee]", 
        RowBox[{"fun", "[", "solTry", "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{"Compute", " ", "Rho"}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{"numerator", "\[DoubleRightTee]", 
        RowBox[{"fTry", "-", "funcVal"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"denominator", "\[DoubleRightTee]", 
        RowBox[{
         RowBox[{"gradVal", ".", "solInner"}], "+", 
         RowBox[{"0.5", " ", 
          RowBox[{"solInner", ".", "hessVal", ".", "solInner"}]}]}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"SMSIf", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"SMSAbs", "[", "numerator", "]"}], "<", 
          RowBox[{"10", "^", 
           RowBox[{"-", "16"}]}]}], "&&", 
         RowBox[{
          RowBox[{"SMSAbs", "[", 
           RowBox[{"numerator", "-", "denominator"}], "]"}], "<", 
          RowBox[{"10", "^", 
           RowBox[{"-", "16"}]}]}]}], "]"}], ";", "\[IndentingNewLine]", "\t", 
       RowBox[{"rho", "\[DoubleLeftTee]", "1"}], ";", "\[IndentingNewLine]", 
       RowBox[{"SMSElse", "[", "]"}], ";", "\[IndentingNewLine]", "\t", 
       RowBox[{"rho", "\[LeftTee]", 
        RowBox[{"numerator", "/", "denominator"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"SMSEndIf", "[", "rho", "]"}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"verbose", ">", "1"}], ",", 
         RowBox[{"SMSPrint", "[", 
          RowBox[{
          "\"\<Rho = \>\"", ",", "rho", ",", "\"\< Numerator = \>\"", ",", 
           "numerator", ",", "\"\< Denominator = \>\"", ",", "denominator", 
           ",", " ", 
           RowBox[{"\"\<Optimal\>\"", "->", "True"}]}], "]"}]}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{"Update", " ", "Solution"}], "*)"}], "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"SMSIf", "[", 
        RowBox[{"rho", ">", "0.2"}], "]"}], ";", "\[IndentingNewLine]", "\t", 
       RowBox[{"sol", "\[LeftTee]", "solTry"}], ";", "\[IndentingNewLine]", 
       "\t", 
       RowBox[{"funcVal", "\[LeftTee]", 
        RowBox[{"fun", "[", "sol", "]"}]}], ";", "\[IndentingNewLine]", "\t", 
       RowBox[{"gradVal", "\[LeftTee]", 
        RowBox[{"grad", "[", "sol", "]"}]}], ";", "\[IndentingNewLine]", "\t", 
       RowBox[{"hessVal", "\[LeftTee]", 
        RowBox[{"hess", "[", "sol", "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"SMSEndIf", "[", 
        RowBox[{"sol", ",", " ", "funcVal", ",", "gradVal", ",", "hessVal"}], 
        "]"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"SMSIf", "[", 
        RowBox[{"rho", " ", "<", " ", 
         RowBox[{"1", "/", "4"}]}], "]"}], ";", "\[IndentingNewLine]", "\t", 
       RowBox[{"delta", "\[LeftTee]", 
        RowBox[{"delta", "/", "4"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"SMSEndIf", "[", "delta", "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"SMSPrint", "[", 
        RowBox[{"\"\<Delta = \>\"", ",", "delta", ",", " ", 
         RowBox[{"\"\<Optimal\>\"", "->", "True"}]}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"SMSIf", "[", 
        RowBox[{
         RowBox[{"rho", " ", ">", " ", "0.8"}], " ", "&&", " ", 
         RowBox[{
          RowBox[{"SMSAbs", "[", 
           RowBox[{"delta", " ", "-", " ", 
            RowBox[{"Norm", "[", "sol", "]"}]}], "]"}], ">=", " ", 
          RowBox[{
           RowBox[{"10", "^", 
            RowBox[{"-", "8"}]}], "*", "delta"}]}], "&&", 
         RowBox[{"delta", "<", "10"}]}], "]"}], ";", "\[IndentingNewLine]", 
       "\t", 
       RowBox[{"delta", "\[LeftTee]", 
        RowBox[{"2", "*", "delta"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"SMSEndIf", "[", "delta", "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{"Stopping", " ", "Conditions"}], "*)"}], 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"SMSIf", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Norm", "[", "gradVal", "]"}], "<", 
          RowBox[{"10", "^", 
           RowBox[{"-", "12"}]}]}], "||", 
         RowBox[{"i", "==", "10000"}]}], "]"}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", "\t", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"verbose", ">", "0"}], ",", 
         RowBox[{"SMSPrint", "[", 
          RowBox[{"\"\<Gradient = \>\"", ",", 
           RowBox[{"Norm", "[", "gradVal", "]"}], ",", 
           "\"\<  Outer iterations = \>\"", ",", "i", ",", " ", 
           RowBox[{"\"\<Optimal\>\"", "->", "True"}]}], "]"}]}], "]"}], ";", 
       "\[IndentingNewLine]", "\t", 
       RowBox[{"SMSBreak", "[", "]"}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"SMSEndIf", "[", "]"}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"SMSEndDo", "[", "sol", "]"}], ";", "\[IndentingNewLine]", 
       "sol"}]}], "\[IndentingNewLine]", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}]], "Input",
 CellChangeTimes->{{3.9465444479977083`*^9, 3.946544483501905*^9}, {
   3.946545100075551*^9, 3.946545183517581*^9}, {3.946545220550153*^9, 
   3.946545372685753*^9}, {3.946545428677854*^9, 3.946545453101589*^9}, {
   3.946545762780414*^9, 3.946545805230424*^9}, {3.9465458506223297`*^9, 
   3.946545857340954*^9}, 3.9465459256921377`*^9, {3.946546088113155*^9, 
   3.9465464112401752`*^9}, {3.9465464591476097`*^9, 3.946546467398374*^9}, {
   3.9465471472071657`*^9, 3.9465471647967453`*^9}, {3.946547224734761*^9, 
   3.946547230445859*^9}, {3.9465473079191437`*^9, 3.946547308198434*^9}, {
   3.946547383949868*^9, 3.946547388070413*^9}, {3.946547424245617*^9, 
   3.946547435676053*^9}, 3.9465474939182997`*^9, {3.9465475283094807`*^9, 
   3.9465475623569937`*^9}, {3.946547646780698*^9, 3.946547647068836*^9}, {
   3.9465595268362007`*^9, 3.946559552351368*^9}, {3.946560236781304*^9, 
   3.946560312219819*^9}, {3.946560350529196*^9, 3.946560350911776*^9}, {
   3.9465606107725487`*^9, 3.946560659965871*^9}, {3.946560744224495*^9, 
   3.9465607510640707`*^9}, {3.9465609310162687`*^9, 3.946560933143293*^9}, 
   3.9465610371521177`*^9, {3.946561613111635*^9, 3.946561616832293*^9}, {
   3.946561797487714*^9, 3.9465618159590597`*^9}, {3.946562257220179*^9, 
   3.946562260600925*^9}, {3.9465652811469383`*^9, 3.9465652828099947`*^9}, {
   3.946565356990841*^9, 3.9465653584576178`*^9}, {3.946573737150627*^9, 
   3.946573763222642*^9}, {3.9465743936730967`*^9, 3.9465744124474993`*^9}, {
   3.946574550376478*^9, 3.946574556311294*^9}, {3.9465747604394283`*^9, 
   3.946574761062989*^9}, {3.9465748947121973`*^9, 3.946574896391165*^9}, {
   3.9465749606996098`*^9, 3.946574966766774*^9}, {3.9465750490478477`*^9, 
   3.946575059615093*^9}, {3.946575421334116*^9, 3.9465754236714783`*^9}, {
   3.946633462887691*^9, 3.946633501577928*^9}, 3.946633585875243*^9, {
   3.9466336460668488`*^9, 3.946633667337422*^9}, {3.946654115250122*^9, 
   3.9466541174536133`*^9}, {3.946654333767172*^9, 3.9466543461974077`*^9}, 
   3.946654454648994*^9, {3.946655723814699*^9, 3.946655727581517*^9}, {
   3.9466631979729757`*^9, 
   3.946663217058305*^9}},ExpressionUUID->"d232c276-3a17-4009-913c-\
0d0c062189cb"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Trust Region with Augmented Lagrangian algorithm", "Subsubsection",
 CellChangeTimes->{{3.9466207755884237`*^9, 3.946620801768663*^9}, {
  3.9466252345862207`*^9, 
  3.946625246039797*^9}},ExpressionUUID->"872f6898-a059-4890-87b8-\
4d071f622507"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"TrustRegionLgr", "[", 
    RowBox[{
    "fun_", ",", "grad_", ",", "hess_", ",", "\[Lambda]In_", ",", 
     "penaltyIn_", ",", "deltaIn_", ",", "x0_", ",", "lb_", ",", "verbose_"}],
     "]"}], ":=", "\[IndentingNewLine]", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "w1", ",", "w2", ",", "sol", ",", "x", ",", "\[Lambda]", ",", "penalty",
        ",", "funLA", ",", "gradLA", ",", "hessLA"}], "}"}], ",", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"funLA", "[", "x_", "]"}], ":=", 
        RowBox[{
         RowBox[{"fun", "[", "x", "]"}], "+", 
         RowBox[{"LgrFun", "[", 
          RowBox[{"x", ",", "\[Lambda]", ",", "lb", ",", "penalty"}], 
          "]"}]}]}], ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"gradLA", "[", "x_", "]"}], ":=", 
        RowBox[{
         RowBox[{"grad", "[", "x", "]"}], "+", 
         RowBox[{"LgrGrad", "[", 
          RowBox[{"x", ",", "\[Lambda]", ",", "lb", ",", "penalty"}], 
          "]"}]}]}], ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"hessLA", "[", "x_", "]"}], ":=", 
        RowBox[{
         RowBox[{"hess", "[", "x", "]"}], "+", 
         RowBox[{"LgrHess", "[", 
          RowBox[{"x", ",", "\[Lambda]", ",", "lb", ",", "penalty"}], 
          "]"}]}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"penalty", "\[DoubleLeftTee]", "penaltyIn"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"\[Lambda]", "\[DoubleLeftTee]", 
        RowBox[{"LgrUpdate", "[", 
         RowBox[{"x0", ",", "\[Lambda]In", ",", "lb", ",", "penalty"}], 
         "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"w1", "\[DoubleLeftTee]", 
        RowBox[{"1", "/", 
         RowBox[{"(", 
          RowBox[{"penalty", "^", "0.1"}], ")"}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"w2", "\[DoubleLeftTee]", 
        RowBox[{"1", "/", "penalty"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"sol", "\[DoubleLeftTee]", "x0"}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"SMSDo", "[", 
        RowBox[{"iter", ",", "1", ",", "100", ",", "1", ",", 
         RowBox[{"{", 
          RowBox[{
          "sol", ",", "penalty", ",", "\[Lambda]", ",", "w1", ",", "w2"}], 
          "}"}]}], "]"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"sol", " ", "\[LeftTee]", 
        RowBox[{"TrustRegion", "[", 
         RowBox[{
         "funLA", ",", "gradLA", ",", "hessLA", ",", "deltaIn", ",", "x0", 
          ",", "1"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"Print", "[", "\"\<After sol TrustRegion\>\"", "]"}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"SMSIf", "[", " ", 
        RowBox[{
         RowBox[{"Norm", "[", 
          RowBox[{"ConstraintsViolation", "[", 
           RowBox[{"sol", ",", "\[Lambda]", ",", "lb", ",", "penalty"}], 
           "]"}], "]"}], "\[LessEqual]", "w1"}], "]"}], ";"}], 
      "\[IndentingNewLine]", "\t", 
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{"penalty", "\[LeftTee]", "penalty"}], ";"}], "*)"}], ";", 
      "\[IndentingNewLine]", "\t", 
      RowBox[{"\[Lambda]", "\[LeftTee]", 
       RowBox[{"LgrUpdate", "[", 
        RowBox[{"sol", ",", "\[Lambda]", ",", "lb", ",", "penalty"}], "]"}]}],
       ";", " ", "\[IndentingNewLine]", "\t", 
      RowBox[{"SMSPrint", "[", 
       RowBox[{"\"\<Lgr update = \>\"", ",", "\[Lambda]", ",", " ", 
        RowBox[{"\"\<Optimal\>\"", "->", "True"}]}], "]"}], ";", 
      "\[IndentingNewLine]", "\t", 
      RowBox[{"w1", "\[LeftTee]", 
       RowBox[{"w1", "/", 
        RowBox[{"(", 
         RowBox[{"penalty", "^", "0.8"}], ")"}]}]}], ";", 
      "\[IndentingNewLine]", "\t", 
      RowBox[{"w2", "\[LeftTee]", 
       RowBox[{"w2", "/", "penalty"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"SMSElse", "[", "]"}], ";", "\[IndentingNewLine]", "\t", 
      RowBox[{"penalty", "\[LeftTee]", 
       RowBox[{"penalty", "*", "2"}]}], ";", "\[IndentingNewLine]", "\t", 
      RowBox[{"SMSPrint", "[", 
       RowBox[{"\"\<Penalty update = \>\"", ",", "penalty", ",", " ", 
        RowBox[{"\"\<Optimal\>\"", "->", "True"}]}], "]"}], ";", 
      "\[IndentingNewLine]", "\t", 
      RowBox[{"w1", "\[LeftTee]", 
       RowBox[{"1", "/", 
        RowBox[{"(", 
         RowBox[{"penalty", "^", "0.1"}], ")"}]}]}], ";", 
      "\[IndentingNewLine]", "\t", 
      RowBox[{"w2", "\[LeftTee]", 
       RowBox[{"1", "/", "penalty"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"SMSEndIf", "[", 
       RowBox[{"penalty", ",", "\[Lambda]", ",", "w1", ",", "w2"}], "]"}], 
      ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"SMSIf", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Norm", "[", 
          RowBox[{"gradLA", "[", "sol", "]"}], " ", "]"}], "<=", 
         RowBox[{"10", "^", 
          RowBox[{"-", "12"}]}]}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"SMSPrint", "[", 
          RowBox[{"\"\<Gradient final= \>\"", ",", 
           RowBox[{"Norm", "[", 
            RowBox[{"gradLA", "[", "sol", "]"}], " ", "]"}], ",", 
           "\"\<  Outer iterations = \>\"", ",", "iter", ",", " ", 
           RowBox[{"\"\<Optimal\>\"", "->", "True"}]}], "]"}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"SMSBreak", "[", "]"}], ";"}]}], "\[IndentingNewLine]", " ", 
       "]"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"SMSEndDo", "[", "sol", "]"}], ";", "\[IndentingNewLine]", 
      "sol"}]}], "\[IndentingNewLine]", "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.946625332999254*^9, 3.946625354495638*^9}, {
   3.946625425478113*^9, 3.946625582721354*^9}, {3.9466256217621727`*^9, 
   3.946625673129139*^9}, {3.946625823338091*^9, 3.9466258726344223`*^9}, {
   3.946625927243401*^9, 3.94662598540333*^9}, {3.946626025426888*^9, 
   3.946626055505539*^9}, {3.946626498700492*^9, 3.946626512890889*^9}, {
   3.94662659425203*^9, 3.94662674013971*^9}, {3.946626789876306*^9, 
   3.946626835852066*^9}, {3.946626921668353*^9, 3.946626924500196*^9}, {
   3.946626967508376*^9, 3.946627014627665*^9}, {3.946627063036635*^9, 
   3.9466270710519238`*^9}, 3.9466327211500263`*^9, {3.946632784126637*^9, 
   3.946632804246331*^9}, {3.946632836430502*^9, 3.946632846893935*^9}, {
   3.9466328921989727`*^9, 3.9466328997191067`*^9}, {3.9466329414626713`*^9, 
   3.946632974752432*^9}, {3.946633053615335*^9, 3.946633066455484*^9}, {
   3.946633098666572*^9, 3.9466331500317497`*^9}, 3.946633181544098*^9, {
   3.946633401896449*^9, 3.946633419751792*^9}, {3.9466335210121098`*^9, 
   3.946633561384012*^9}, {3.9466337541375723`*^9, 3.946633781585112*^9}, {
   3.946633823113591*^9, 3.9466338424656277`*^9}, 3.946633883009849*^9, {
   3.946633961425123*^9, 3.946633993001568*^9}, {3.9466340281871557`*^9, 
   3.946634044345747*^9}, {3.946648825002534*^9, 3.94664885178353*^9}, {
   3.946649642005251*^9, 3.946649672365822*^9}, {3.946649724205762*^9, 
   3.9466497283484592`*^9}, {3.9466497927183657`*^9, 3.946649796053446*^9}, {
   3.946649863485919*^9, 3.9466498687096367`*^9}, {3.946649918629438*^9, 
   3.946649929413677*^9}, {3.946650046582127*^9, 3.9466500498852787`*^9}, {
   3.9466500853236523`*^9, 3.9466500893576717`*^9}, {3.9466501324056177`*^9, 
   3.9466501394609833`*^9}, {3.9466502606461773`*^9, 3.946650338757794*^9}, {
   3.9466503712381563`*^9, 3.946650589343461*^9}, {3.9466506384476852`*^9, 
   3.946650666687337*^9}, {3.946650747215146*^9, 3.9466507698556833`*^9}, {
   3.9466508008399*^9, 3.946650865576682*^9}, {3.946651672145319*^9, 
   3.9466516998489933`*^9}, {3.9466517651119137`*^9, 3.946651789769149*^9}, {
   3.946651822249325*^9, 3.946652095729067*^9}, {3.9466525380858603`*^9, 
   3.946652568146922*^9}, {3.946653527164085*^9, 3.946653531996093*^9}, {
   3.946653595987338*^9, 3.9466535963147783`*^9}, {3.946653627522504*^9, 
   3.94665365309167*^9}, {3.946653746504195*^9, 3.946653781166122*^9}, {
   3.9466538213324947`*^9, 3.946653825459764*^9}, {3.94665417902322*^9, 
   3.946654189180447*^9}, {3.946654229875924*^9, 3.946654233332452*^9}, {
   3.946654500051866*^9, 3.946654538172331*^9}, {3.946655025953679*^9, 
   3.946655042787673*^9}, 3.946655099163641*^9, {3.9466551463910933`*^9, 
   3.946655187307939*^9}, {3.9466552448594933`*^9, 3.946655245251053*^9}, {
   3.9466553544985247`*^9, 3.946655358099053*^9}, {3.946655503605473*^9, 
   3.946655530972239*^9}, {3.946655703724606*^9, 3.94665573742736*^9}, {
   3.9466565325202293`*^9, 3.94665653827607*^9}, {3.946657306925477*^9, 
   3.946657349933489*^9}, {3.9466576036060047`*^9, 3.9466576040466547`*^9}, {
   3.946657836934223*^9, 3.9466578371354856`*^9}, {3.946657925117488*^9, 
   3.9466579488855867`*^9}, {3.9466580921183453`*^9, 3.94665811191825*^9}, {
   3.9466582163262777`*^9, 3.94665822602206*^9}, 3.946658423585092*^9, {
   3.946661108848139*^9, 3.9466611348959913`*^9}, {3.946661338439934*^9, 
   3.9466613429116488`*^9}},
 CellLabel->
  "In[399]:=",ExpressionUUID->"570334ca-de98-4b8a-ae79-30bf47b13425"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Main Module", "Subsubsection",
 CellChangeTimes->{{3.9466208186811943`*^9, 
  3.946620841280623*^9}},ExpressionUUID->"7ecbfff5-2f28-4a02-817c-\
2f990e07c10d"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"fun", "[", "x_", "]"}], ":=", 
    RowBox[{"x", ".", "x"}]}], ";"}], " ", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"Example", " ", "quadratic", " ", "function", " ", "f", 
     RowBox[{"(", "x", ")"}]}], "=", 
    RowBox[{
     RowBox[{"x", "^", "T"}], " ", "x"}]}], "*)"}]}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"grad", "[", "x_", "]"}], ":=", 
    RowBox[{"2", " ", "x"}]}], ";"}], " ", 
  RowBox[{"(*", 
   RowBox[{"Gradient", " ", "of", " ", "f", 
    RowBox[{"(", "x", ")"}]}], "*)"}]}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"hess", "[", "x_", "]"}], ":=", 
    RowBox[{"2", " ", 
     RowBox[{"IdentityMatrix", "[", 
      RowBox[{"Length", "[", "x", "]"}], "]"}]}]}], ";"}], " ", 
  RowBox[{"(*", 
   RowBox[{"Hessian", " ", "of", " ", "f", 
    RowBox[{"(", "x", ")"}]}], "*)"}]}]}], "Input",
 CellLabel->
  "In[400]:=",ExpressionUUID->"aaf70963-0479-45ba-a12b-c57521e33eb3"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"Define", " ", "the", " ", "Rosenbrock", " ", "function"}], "*)"}],
   "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"rosenbrock", "[", "x_", "]"}], ":=", 
     RowBox[{"Sum", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"100", " ", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"x", "[", 
             RowBox[{"[", 
              RowBox[{"i", "+", "1"}], "]"}], "]"}], "-", 
            RowBox[{
             RowBox[{"x", "[", 
              RowBox[{"[", "i", "]"}], "]"}], "^", "2"}]}], ")"}], "^", 
          "2"}]}], "+", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"1", "-", 
           RowBox[{"x", "[", 
            RowBox[{"[", "i", "]"}], "]"}]}], ")"}], "^", "2"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", 
         RowBox[{
          RowBox[{"Length", "[", "x", "]"}], "-", "1"}]}], "}"}]}], "]"}]}], 
    ";"}], "\n", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "Gradient", " ", "of", " ", "the", " ", "Rosenbrock", " ", "function"}], 
    "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"rosenbrockGrad", "[", "x_", "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"n", "=", 
          RowBox[{"Length", "[", "x", "]"}]}], ",", "grad"}], "}"}], ",", 
       RowBox[{
        RowBox[{"grad", "=", 
         RowBox[{"Table", "[", 
          RowBox[{"0.0", ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "n"}], "}"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"For", "[", 
         RowBox[{
          RowBox[{"i", "=", "1"}], ",", 
          RowBox[{"i", "<=", 
           RowBox[{"n", "-", "1"}]}], ",", 
          RowBox[{"i", "++"}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"grad", "[", 
             RowBox[{"[", "i", "]"}], "]"}], "+=", 
            RowBox[{
             RowBox[{
              RowBox[{"-", "400"}], " ", 
              RowBox[{"x", "[", 
               RowBox[{"[", "i", "]"}], "]"}], " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"x", "[", 
                 RowBox[{"[", 
                  RowBox[{"i", "+", "1"}], "]"}], "]"}], "-", 
                RowBox[{
                 RowBox[{"x", "[", 
                  RowBox[{"[", "i", "]"}], "]"}], "^", "2"}]}], ")"}]}], "-", 
             RowBox[{"2", " ", 
              RowBox[{"(", 
               RowBox[{"1", "-", 
                RowBox[{"x", "[", 
                 RowBox[{"[", "i", "]"}], "]"}]}], ")"}]}]}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"grad", "[", 
             RowBox[{"[", 
              RowBox[{"i", "+", "1"}], "]"}], "]"}], "+=", 
            RowBox[{"200", " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"x", "[", 
                RowBox[{"[", 
                 RowBox[{"i", "+", "1"}], "]"}], "]"}], "-", 
               RowBox[{
                RowBox[{"x", "[", 
                 RowBox[{"[", "i", "]"}], "]"}], "^", "2"}]}], ")"}]}]}], 
           ";"}]}], "]"}], ";", "\[IndentingNewLine]", "grad"}]}], 
      "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "Hessian", " ", "of", " ", "the", " ", "Rosenbrock", " ", "function"}], 
    "*)"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"rosenbrockHess", "[", "x_", "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"n", "=", 
          RowBox[{"Length", "[", "x", "]"}]}], ",", "hess"}], "}"}], ",", 
       RowBox[{
        RowBox[{"hess", "=", 
         RowBox[{"Table", "[", 
          RowBox[{"0.0", ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "n"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"j", ",", "n"}], "}"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"For", "[", 
         RowBox[{
          RowBox[{"i", "=", "1"}], ",", 
          RowBox[{"i", "<=", 
           RowBox[{"n", "-", "1"}]}], ",", 
          RowBox[{"i", "++"}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"hess", "[", 
             RowBox[{"[", 
              RowBox[{"i", ",", "i"}], "]"}], "]"}], "+=", 
            RowBox[{
             RowBox[{"1200", " ", 
              RowBox[{
               RowBox[{"x", "[", 
                RowBox[{"[", "i", "]"}], "]"}], "^", "2"}]}], "-", 
             RowBox[{"400", " ", 
              RowBox[{"x", "[", 
               RowBox[{"[", 
                RowBox[{"i", "+", "1"}], "]"}], "]"}]}], "+", "2"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"hess", "[", 
             RowBox[{"[", 
              RowBox[{"i", ",", 
               RowBox[{"i", "+", "1"}]}], "]"}], "]"}], "+=", 
            RowBox[{
             RowBox[{"-", "400"}], " ", 
             RowBox[{"x", "[", 
              RowBox[{"[", "i", "]"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"hess", "[", 
             RowBox[{"[", 
              RowBox[{
               RowBox[{"i", "+", "1"}], ",", "i"}], "]"}], "]"}], "+=", 
            RowBox[{
             RowBox[{"-", "400"}], " ", 
             RowBox[{"x", "[", 
              RowBox[{"[", "i", "]"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"hess", "[", 
             RowBox[{"[", 
              RowBox[{
               RowBox[{"i", "+", "1"}], ",", 
               RowBox[{"i", "+", "1"}]}], "]"}], "]"}], "+=", "200"}], 
           ";"}]}], "]"}], ";", "\[IndentingNewLine]", "hess"}]}], "]"}]}], 
    ";"}]}]}]], "Input",
 CellChangeTimes->{{3.946548430119348*^9, 3.946548433584635*^9}, 
   3.946574016919158*^9, {3.9466216639149523`*^9, 3.946621696226363*^9}},
 CellLabel->
  "In[403]:=",ExpressionUUID->"b9a07afc-9bc0-4c84-81b4-8a1d9d5ee6ad"],

Cell[BoxData[
 RowBox[{
  RowBox[{"<<", "AceGen`"}], ";"}]], "Input",
 CellChangeTimes->{{3.944582395012553*^9, 3.9445824008847165`*^9}, {
   3.9445824327863197`*^9, 3.94458249360233*^9}, {3.944582591394967*^9, 
   3.9445826707381*^9}, {3.9445828626916385`*^9, 3.9445829920803623`*^9}, {
   3.9445830234749203`*^9, 3.944583023616292*^9}, {3.9445830721145554`*^9, 
   3.944583089008497*^9}, {3.944585458628723*^9, 3.944585572650257*^9}, {
   3.944585620322979*^9, 3.944585671684211*^9}, {3.9445860462699566`*^9, 
   3.944586052073522*^9}, {3.9445872219536963`*^9, 3.94458738647931*^9}, {
   3.9445874540791636`*^9, 3.9445874575660286`*^9}, {3.944588319080059*^9, 
   3.944588325189089*^9}, {3.944588539261174*^9, 3.9445885484766583`*^9}, {
   3.9445889419247684`*^9, 3.944588977475665*^9}, {3.9445894360276256`*^9, 
   3.9445894418260098`*^9}, {3.9445895289954185`*^9, 
   3.9445895342663774`*^9}, {3.9445895905472546`*^9, 3.94458959076863*^9}, 
   3.94458972596357*^9, {3.944590137939025*^9, 3.9445901567519865`*^9}, {
   3.9445902392416983`*^9, 3.944590249567762*^9}, {3.9445903209200954`*^9, 
   3.944590336311578*^9}, {3.9445903908264294`*^9, 3.944590422015356*^9}, {
   3.944591188278614*^9, 3.9445911941095533`*^9}, 3.944591715317357*^9, {
   3.9445918224610567`*^9, 3.9445918227721705`*^9}, {3.9447572037147903`*^9, 
   3.944757488584672*^9}, {3.9447575811212535`*^9, 3.9447575919133244`*^9}, 
   3.9447579046714993`*^9, {3.9447579850323253`*^9, 3.944758023766347*^9}, {
   3.944758342043431*^9, 3.944758403950558*^9}, {3.9447595987656918`*^9, 
   3.9447596001312156`*^9}, {3.9447602345647573`*^9, 
   3.9447602389630527`*^9}, {3.944760601876239*^9, 3.944760653273938*^9}, {
   3.9447607287629004`*^9, 3.9447607292534637`*^9}, {3.9447607966433434`*^9, 
   3.9447607973694515`*^9}, {3.946482340081848*^9, 3.946482366596211*^9}, {
   3.946482639793852*^9, 3.946482870217704*^9}, {3.946482967634367*^9, 
   3.9464831301372766`*^9}, {3.946483165780672*^9, 3.94648324171203*^9}, {
   3.94648343509971*^9, 3.946483537071636*^9}, {3.946483575759655*^9, 
   3.9464835809509172`*^9}, {3.946483611881505*^9, 3.9464836156468363`*^9}, {
   3.946483701222746*^9, 3.946483767279086*^9}, {3.946484287151932*^9, 
   3.946484326221816*^9}, {3.946484446656472*^9, 3.946484471854545*^9}, {
   3.946484857335958*^9, 3.946484880526752*^9}, {3.946485012207767*^9, 
   3.946485015139759*^9}, 3.946485093481909*^9, {3.946485804252454*^9, 
   3.946485839740264*^9}, {3.946486482183919*^9, 3.946486574374709*^9}, {
   3.946486644208784*^9, 3.946486654446877*^9}, {3.946486877386443*^9, 
   3.94648687830376*^9}, 3.946487003858149*^9, {3.9464870712899513`*^9, 
   3.946487124737178*^9}, {3.9464871760424137`*^9, 3.946487179289963*^9}, {
   3.9464872892541018`*^9, 3.9464873500519133`*^9}, {3.946487380269559*^9, 
   3.946487380899185*^9}, 3.9464874150194187`*^9, {3.94648783534308*^9, 
   3.946487906836109*^9}, {3.946488172145102*^9, 3.946488173766425*^9}, {
   3.946488237250154*^9, 3.946488245111073*^9}, {3.946488341546872*^9, 
   3.946488407647402*^9}, {3.94648848509734*^9, 3.946488515909651*^9}, {
   3.946488795341139*^9, 3.946488803108308*^9}, 3.946488853397708*^9, {
   3.946489810417493*^9, 3.946489829016287*^9}, {3.946490304358346*^9, 
   3.946490308724102*^9}, {3.946490352622755*^9, 3.946490358972327*^9}, {
   3.946490472306727*^9, 3.946490497352553*^9}, {3.946490816714511*^9, 
   3.946490875737713*^9}, {3.946491103187711*^9, 3.946491104496374*^9}, {
   3.9464911523399277`*^9, 3.946491153400877*^9}, 3.946545725468142*^9, {
   3.946547693093314*^9, 3.9465476992299147`*^9}, {3.946548471848366*^9, 
   3.946548493753489*^9}, {3.9465485878882523`*^9, 3.94654858964156*^9}, 
   3.9465581821337748`*^9},
 CellLabel->
  "In[406]:=",ExpressionUUID->"5c4a5128-1846-4400-b5e2-68b67b525d38"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"SMSInitialize", "[", 
    RowBox[{"\"\<SubproblemAceGenTest\>\"", ",", 
     RowBox[{"\"\<Language\>\"", "\[Rule]", "\"\<C\>\""}], ",", 
     RowBox[{"\"\<Mode\>\"", "->", "\"\<Optimal\>\""}]}], "]"}], ";"}], " ", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"SMSInitialize", "[", 
     RowBox[{"\"\<SubproblemAceGenTest\>\"", ",", 
      RowBox[{"\"\<Language\>\"", "\[Rule]", "\"\<C\>\""}], ",", 
      RowBox[{"\"\<Mode\>\"", "->", "\"\<Optimal\>\""}]}], "]"}], ";"}], " ", 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"n", "=", "2"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"SMSModule", "[", 
   RowBox[{"\"\<SubproblemAceGenTest\>\"", ",", 
    RowBox[{"Real", "[", 
     RowBox[{
      RowBox[{"solution$$", "[", "n", "]"}], ",", 
      RowBox[{"lb$$", "[", "n", "]"}]}], " ", "]"}]}], " ", "]"}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.944582395012553*^9, 3.9445824008847165`*^9}, {
   3.9445824327863197`*^9, 3.94458249360233*^9}, {3.944582591394967*^9, 
   3.9445826707381*^9}, {3.9445828626916385`*^9, 3.9445829920803623`*^9}, {
   3.9445830234749203`*^9, 3.944583023616292*^9}, {3.9445830721145554`*^9, 
   3.944583089008497*^9}, {3.944585458628723*^9, 3.944585572650257*^9}, {
   3.944585620322979*^9, 3.944585671684211*^9}, {3.9445860462699566`*^9, 
   3.944586052073522*^9}, {3.9445872219536963`*^9, 3.94458738647931*^9}, {
   3.9445874540791636`*^9, 3.9445874575660286`*^9}, {3.944588319080059*^9, 
   3.944588325189089*^9}, {3.944588539261174*^9, 3.9445885484766583`*^9}, {
   3.9445889419247684`*^9, 3.944588977475665*^9}, {3.9445894360276256`*^9, 
   3.9445894418260098`*^9}, {3.9445895289954185`*^9, 
   3.9445895342663774`*^9}, {3.9445895905472546`*^9, 3.94458959076863*^9}, 
   3.94458972596357*^9, {3.944590137939025*^9, 3.9445901567519865`*^9}, {
   3.9445902392416983`*^9, 3.944590249567762*^9}, {3.9445903209200954`*^9, 
   3.944590336311578*^9}, {3.9445903908264294`*^9, 3.944590422015356*^9}, {
   3.944591188278614*^9, 3.9445911941095533`*^9}, 3.944591715317357*^9, {
   3.9445918224610567`*^9, 3.9445918227721705`*^9}, {3.9447572037147903`*^9, 
   3.944757488584672*^9}, {3.9447575811212535`*^9, 3.9447575919133244`*^9}, 
   3.9447579046714993`*^9, {3.9447579850323253`*^9, 3.944758023766347*^9}, {
   3.944758342043431*^9, 3.944758403950558*^9}, {3.9447595987656918`*^9, 
   3.9447596001312156`*^9}, {3.9447602345647573`*^9, 
   3.9447602389630527`*^9}, {3.944760601876239*^9, 3.944760653273938*^9}, {
   3.9447607287629004`*^9, 3.9447607292534637`*^9}, {3.9447607966433434`*^9, 
   3.9447607973694515`*^9}, {3.946482340081848*^9, 3.946482366596211*^9}, {
   3.946482639793852*^9, 3.946482870217704*^9}, {3.946482967634367*^9, 
   3.9464831301372766`*^9}, {3.946483165780672*^9, 3.94648324171203*^9}, {
   3.94648343509971*^9, 3.946483537071636*^9}, {3.946483575759655*^9, 
   3.9464835809509172`*^9}, {3.946483611881505*^9, 3.9464836156468363`*^9}, {
   3.946483701222746*^9, 3.946483767279086*^9}, {3.946484287151932*^9, 
   3.946484326221816*^9}, {3.946484446656472*^9, 3.946484471854545*^9}, {
   3.946484857335958*^9, 3.946484880526752*^9}, {3.946485012207767*^9, 
   3.946485015139759*^9}, 3.946485093481909*^9, {3.946485804252454*^9, 
   3.946485839740264*^9}, {3.946486482183919*^9, 3.946486574374709*^9}, {
   3.946486644208784*^9, 3.946486654446877*^9}, {3.946486877386443*^9, 
   3.94648687830376*^9}, 3.946487003858149*^9, {3.9464870712899513`*^9, 
   3.946487124737178*^9}, {3.9464871760424137`*^9, 3.946487179289963*^9}, {
   3.9464872892541018`*^9, 3.9464873500519133`*^9}, {3.946487380269559*^9, 
   3.946487380899185*^9}, 3.9464874150194187`*^9, {3.94648783534308*^9, 
   3.946487906836109*^9}, {3.946488172145102*^9, 3.946488173766425*^9}, {
   3.946488237250154*^9, 3.946488245111073*^9}, {3.946488341546872*^9, 
   3.946488407647402*^9}, {3.94648848509734*^9, 3.946488515909651*^9}, {
   3.946488795341139*^9, 3.946488803108308*^9}, 3.946488853397708*^9, {
   3.946489810417493*^9, 3.946489829016287*^9}, {3.946490304358346*^9, 
   3.946490308724102*^9}, {3.946490352622755*^9, 3.946490358972327*^9}, {
   3.946490472306727*^9, 3.946490497352553*^9}, {3.946490816714511*^9, 
   3.946490875737713*^9}, {3.946491103187711*^9, 3.946491104496374*^9}, {
   3.9464911523399277`*^9, 3.946491153400877*^9}, 3.946545725468142*^9, {
   3.946547693093314*^9, 3.9465476992299147`*^9}, {3.946548471848366*^9, 
   3.946548493753489*^9}, {3.9465485878882523`*^9, 3.94654858964156*^9}, 
   3.9465581821337748`*^9, {3.946559193919379*^9, 3.946559208374893*^9}, {
   3.9465595683449306`*^9, 3.946559596014286*^9}, {3.946559680540257*^9, 
   3.9465597067661333`*^9}, {3.9465597719428043`*^9, 3.946559785606216*^9}, {
   3.946561220901621*^9, 3.946561222483467*^9}, {3.946562051171575*^9, 
   3.946562131651311*^9}, {3.946562318285864*^9, 3.946562324618657*^9}, {
   3.946563844091837*^9, 3.9465638557769823`*^9}, {3.9465744584954967`*^9, 
   3.946574460252626*^9}, {3.946574590141427*^9, 3.946574593852888*^9}, {
   3.946574733066743*^9, 3.946574750596258*^9}, 3.9465754590898952`*^9, {
   3.9465754912977*^9, 3.946575498482459*^9}, 3.9466507018004227`*^9, {
   3.946650950447047*^9, 3.9466509506548233`*^9}, 3.946651731245531*^9, {
   3.946655871466131*^9, 3.946655877576763*^9}},
 CellLabel->
  "In[407]:=",ExpressionUUID->"bde6b50e-1de4-417a-96b9-97ba03a855da"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"x0", "\[DoubleRightTee]", 
   RowBox[{"SMSReal", "[", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"solution$$", "[", "i", "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", "n"}], "}"}]}], "]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"lb", "\[DoubleRightTee]", 
    RowBox[{"SMSReal", "[", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"lb$$", "[", "i", "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "n"}], "}"}]}], "]"}], "]"}]}], ";"}], 
  RowBox[{"(*", 
   RowBox[{"Starting", " ", "point"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Lambda]In", "\[DoubleRightTee]", 
   RowBox[{"Table", "[", 
    RowBox[{"0", ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "n"}], "}"}]}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"penaltyIn", "\[DoubleRightTee]", "100"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"deltaIn", "=", "0.5"}], ";"}], " ", 
  RowBox[{"(*", 
   RowBox[{"Initial", " ", "trust", " ", "region", " ", "radius"}], 
   "*)"}]}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"verbose", "=", "1"}], ";"}], " ", 
  RowBox[{"(*", 
   RowBox[{"Verbosity", " ", "level"}], "*)"}]}]}], "Input",
 CellChangeTimes->{{3.944582395012553*^9, 3.9445824008847165`*^9}, {
   3.9445824327863197`*^9, 3.94458249360233*^9}, {3.944582591394967*^9, 
   3.9445826707381*^9}, {3.9445828626916385`*^9, 3.9445829920803623`*^9}, {
   3.9445830234749203`*^9, 3.944583023616292*^9}, {3.9445830721145554`*^9, 
   3.944583089008497*^9}, {3.944585458628723*^9, 3.944585572650257*^9}, {
   3.944585620322979*^9, 3.944585671684211*^9}, {3.9445860462699566`*^9, 
   3.944586052073522*^9}, {3.9445872219536963`*^9, 3.94458738647931*^9}, {
   3.9445874540791636`*^9, 3.9445874575660286`*^9}, {3.944588319080059*^9, 
   3.944588325189089*^9}, {3.944588539261174*^9, 3.9445885484766583`*^9}, {
   3.9445889419247684`*^9, 3.944588977475665*^9}, {3.9445894360276256`*^9, 
   3.9445894418260098`*^9}, {3.9445895289954185`*^9, 
   3.9445895342663774`*^9}, {3.9445895905472546`*^9, 3.94458959076863*^9}, 
   3.94458972596357*^9, {3.944590137939025*^9, 3.9445901567519865`*^9}, {
   3.9445902392416983`*^9, 3.944590249567762*^9}, {3.9445903209200954`*^9, 
   3.944590336311578*^9}, {3.9445903908264294`*^9, 3.944590422015356*^9}, {
   3.944591188278614*^9, 3.9445911941095533`*^9}, 3.944591715317357*^9, {
   3.9445918224610567`*^9, 3.9445918227721705`*^9}, {3.9447572037147903`*^9, 
   3.944757488584672*^9}, {3.9447575811212535`*^9, 3.9447575919133244`*^9}, 
   3.9447579046714993`*^9, {3.9447579850323253`*^9, 3.944758023766347*^9}, {
   3.944758342043431*^9, 3.944758403950558*^9}, {3.9447595987656918`*^9, 
   3.9447596001312156`*^9}, {3.9447602345647573`*^9, 
   3.9447602389630527`*^9}, {3.944760601876239*^9, 3.944760653273938*^9}, {
   3.9447607287629004`*^9, 3.9447607292534637`*^9}, {3.9447607966433434`*^9, 
   3.9447607973694515`*^9}, {3.946482340081848*^9, 3.946482366596211*^9}, {
   3.946482639793852*^9, 3.946482870217704*^9}, {3.946482967634367*^9, 
   3.9464831301372766`*^9}, {3.946483165780672*^9, 3.94648324171203*^9}, {
   3.94648343509971*^9, 3.946483537071636*^9}, {3.946483575759655*^9, 
   3.9464835809509172`*^9}, {3.946483611881505*^9, 3.9464836156468363`*^9}, {
   3.946483701222746*^9, 3.946483767279086*^9}, {3.946484287151932*^9, 
   3.946484326221816*^9}, {3.946484446656472*^9, 3.946484471854545*^9}, {
   3.946484857335958*^9, 3.946484880526752*^9}, {3.946485012207767*^9, 
   3.946485015139759*^9}, 3.946485093481909*^9, {3.946485804252454*^9, 
   3.946485839740264*^9}, {3.946486482183919*^9, 3.946486574374709*^9}, {
   3.946486644208784*^9, 3.946486654446877*^9}, {3.946486877386443*^9, 
   3.94648687830376*^9}, 3.946487003858149*^9, {3.9464870712899513`*^9, 
   3.946487124737178*^9}, {3.9464871760424137`*^9, 3.946487179289963*^9}, {
   3.9464872892541018`*^9, 3.9464873500519133`*^9}, {3.946487380269559*^9, 
   3.946487380899185*^9}, 3.9464874150194187`*^9, {3.94648783534308*^9, 
   3.946487906836109*^9}, {3.946488172145102*^9, 3.946488173766425*^9}, {
   3.946488237250154*^9, 3.946488245111073*^9}, {3.946488341546872*^9, 
   3.946488407647402*^9}, {3.94648848509734*^9, 3.946488515909651*^9}, {
   3.946488795341139*^9, 3.946488803108308*^9}, 3.946488853397708*^9, {
   3.946489810417493*^9, 3.946489829016287*^9}, {3.946490304358346*^9, 
   3.946490308724102*^9}, {3.946490352622755*^9, 3.946490358972327*^9}, {
   3.946490472306727*^9, 3.946490497352553*^9}, {3.946490816714511*^9, 
   3.946490875737713*^9}, {3.946491103187711*^9, 3.946491104496374*^9}, {
   3.9464911523399277`*^9, 3.946491153400877*^9}, 3.946545725468142*^9, {
   3.946547693093314*^9, 3.9465476992299147`*^9}, {3.946548471848366*^9, 
   3.946548493753489*^9}, {3.9465485878882523`*^9, 3.94654858964156*^9}, 
   3.9465581821337748`*^9, {3.946559193919379*^9, 3.946559208374893*^9}, {
   3.9465595683449306`*^9, 3.946559596014286*^9}, {3.946559680540257*^9, 
   3.9465597067661333`*^9}, {3.9465597719428043`*^9, 3.946559785606216*^9}, {
   3.946561220901621*^9, 3.946561222483467*^9}, {3.946562051171575*^9, 
   3.946562131651311*^9}, {3.946562318285864*^9, 3.946562324618657*^9}, {
   3.946563844091837*^9, 3.9465638557769823`*^9}, {3.9465744584954967`*^9, 
   3.946574460252626*^9}, {3.946574590141427*^9, 3.946574593852888*^9}, {
   3.946574733066743*^9, 3.946574750596258*^9}, 3.9465754590898952`*^9, {
   3.9465754912977*^9, 3.946575498482459*^9}, 3.9466507018004227`*^9, {
   3.946650950447047*^9, 3.9466509506548233`*^9}, 3.946651731245531*^9, {
   3.946653441553355*^9, 3.946653443065243*^9}, {3.946653843825601*^9, 
   3.946653986393547*^9}, {3.946654374795082*^9, 3.946654405961301*^9}, 
   3.946654616720543*^9, {3.946655893393879*^9, 3.94665590953791*^9}, {
   3.946658394611682*^9, 3.94665840389891*^9}, {3.946658504442273*^9, 
   3.946658505658495*^9}, {3.9466615121896477`*^9, 3.9466615129166403`*^9}, {
   3.946661608860718*^9, 3.9466616122048492`*^9}, 3.946663083998106*^9},
 CellLabel->
  "In[410]:=",ExpressionUUID->"32ae89f9-eeb0-484e-8d24-6c0eb1dfa651"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"solution", "\[DoubleRightTee]", 
     RowBox[{"TrustRegion", "[", 
      RowBox[{
      "rosenbrock", ",", "rosenbrockGrad", ",", "rosenbrockHess", ",", 
       "delta", ",", "x0", ",", "verbose"}], "]"}]}], ";"}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"solution", "\[DoubleRightTee]", 
   RowBox[{"TrustRegionLgr", "[", 
    RowBox[{
    "fun", ",", "grad", ",", "hess", ",", "\[Lambda]In", ",", "penaltyIn", 
     ",", "deltaIn", ",", "x0", ",", "lb", ",", "verbose"}], 
    "]"}]}]}]], "Input",
 CellChangeTimes->{{3.944582395012553*^9, 3.9445824008847165`*^9}, {
   3.9445824327863197`*^9, 3.94458249360233*^9}, {3.944582591394967*^9, 
   3.9445826707381*^9}, {3.9445828626916385`*^9, 3.9445829920803623`*^9}, {
   3.9445830234749203`*^9, 3.944583023616292*^9}, {3.9445830721145554`*^9, 
   3.944583089008497*^9}, {3.944585458628723*^9, 3.944585572650257*^9}, {
   3.944585620322979*^9, 3.944585671684211*^9}, {3.9445860462699566`*^9, 
   3.944586052073522*^9}, {3.9445872219536963`*^9, 3.94458738647931*^9}, {
   3.9445874540791636`*^9, 3.9445874575660286`*^9}, {3.944588319080059*^9, 
   3.944588325189089*^9}, {3.944588539261174*^9, 3.9445885484766583`*^9}, {
   3.9445889419247684`*^9, 3.944588977475665*^9}, {3.9445894360276256`*^9, 
   3.9445894418260098`*^9}, {3.9445895289954185`*^9, 
   3.9445895342663774`*^9}, {3.9445895905472546`*^9, 3.94458959076863*^9}, 
   3.94458972596357*^9, {3.944590137939025*^9, 3.9445901567519865`*^9}, {
   3.9445902392416983`*^9, 3.944590249567762*^9}, {3.9445903209200954`*^9, 
   3.944590336311578*^9}, {3.9445903908264294`*^9, 3.944590422015356*^9}, {
   3.944591188278614*^9, 3.9445911941095533`*^9}, 3.944591715317357*^9, {
   3.9445918224610567`*^9, 3.9445918227721705`*^9}, {3.9447572037147903`*^9, 
   3.944757488584672*^9}, {3.9447575811212535`*^9, 3.9447575919133244`*^9}, 
   3.9447579046714993`*^9, {3.9447579850323253`*^9, 3.944758023766347*^9}, {
   3.944758342043431*^9, 3.944758403950558*^9}, {3.9447595987656918`*^9, 
   3.9447596001312156`*^9}, {3.9447602345647573`*^9, 
   3.9447602389630527`*^9}, {3.944760601876239*^9, 3.944760653273938*^9}, {
   3.9447607287629004`*^9, 3.9447607292534637`*^9}, {3.9447607966433434`*^9, 
   3.9447607973694515`*^9}, {3.946482340081848*^9, 3.946482366596211*^9}, {
   3.946482639793852*^9, 3.946482870217704*^9}, {3.946482967634367*^9, 
   3.9464831301372766`*^9}, {3.946483165780672*^9, 3.94648324171203*^9}, {
   3.94648343509971*^9, 3.946483537071636*^9}, {3.946483575759655*^9, 
   3.9464835809509172`*^9}, {3.946483611881505*^9, 3.9464836156468363`*^9}, {
   3.946483701222746*^9, 3.946483767279086*^9}, {3.946484287151932*^9, 
   3.946484326221816*^9}, {3.946484446656472*^9, 3.946484471854545*^9}, {
   3.946484857335958*^9, 3.946484880526752*^9}, {3.946485012207767*^9, 
   3.946485015139759*^9}, 3.946485093481909*^9, {3.946485804252454*^9, 
   3.946485839740264*^9}, {3.946486482183919*^9, 3.946486574374709*^9}, {
   3.946486644208784*^9, 3.946486654446877*^9}, {3.946486877386443*^9, 
   3.94648687830376*^9}, 3.946487003858149*^9, {3.9464870712899513`*^9, 
   3.946487124737178*^9}, {3.9464871760424137`*^9, 3.946487179289963*^9}, {
   3.9464872892541018`*^9, 3.9464873500519133`*^9}, {3.946487380269559*^9, 
   3.946487380899185*^9}, 3.9464874150194187`*^9, {3.94648783534308*^9, 
   3.946487906836109*^9}, {3.946488172145102*^9, 3.946488173766425*^9}, {
   3.946488237250154*^9, 3.946488245111073*^9}, {3.946488341546872*^9, 
   3.946488407647402*^9}, {3.94648848509734*^9, 3.946488515909651*^9}, {
   3.946488795341139*^9, 3.946488803108308*^9}, 3.946488853397708*^9, {
   3.946489810417493*^9, 3.946489829016287*^9}, {3.946490304358346*^9, 
   3.946490308724102*^9}, {3.946490352622755*^9, 3.946490358972327*^9}, {
   3.946490472306727*^9, 3.946490497352553*^9}, {3.946490816714511*^9, 
   3.946490875737713*^9}, {3.946491103187711*^9, 3.946491104496374*^9}, {
   3.9464911523399277`*^9, 3.946491153400877*^9}, 3.946545725468142*^9, {
   3.946547693093314*^9, 3.9465476992299147`*^9}, {3.946548471848366*^9, 
   3.946548493753489*^9}, {3.9465485878882523`*^9, 3.94654858964156*^9}, 
   3.9465581821337748`*^9, {3.946559193919379*^9, 3.946559208374893*^9}, {
   3.9465595683449306`*^9, 3.946559596014286*^9}, {3.946559680540257*^9, 
   3.9465597067661333`*^9}, {3.9465597719428043`*^9, 3.946559785606216*^9}, {
   3.946561220901621*^9, 3.946561222483467*^9}, {3.946562051171575*^9, 
   3.946562131651311*^9}, {3.946562318285864*^9, 3.946562324618657*^9}, {
   3.946563844091837*^9, 3.9465638557769823`*^9}, {3.9465744584954967`*^9, 
   3.946574460252626*^9}, {3.946574590141427*^9, 3.946574593852888*^9}, {
   3.946574733066743*^9, 3.946574750596258*^9}, 3.9465754590898952`*^9, {
   3.9465754912977*^9, 3.946575498482459*^9}, 3.9466507018004227`*^9, {
   3.946650950447047*^9, 3.9466509506548233`*^9}, 3.946651731245531*^9, {
   3.946653441553355*^9, 3.946653443065243*^9}, {3.946653843825601*^9, 
   3.946653986393547*^9}, {3.946654374795082*^9, 3.946654405961301*^9}, 
   3.946654616720543*^9},
 CellLabel->
  "In[416]:=",ExpressionUUID->"ec5fdf19-ec11-4493-8151-b0f4293986c5"],

Cell[BoxData["\<\"After sol TrustRegion\"\>"], "Print",
 CellChangeTimes->{3.946654409768488*^9, 3.946654468091342*^9, 
  3.946654548298854*^9, 3.9466549008145943`*^9, 3.946655058937091*^9, 
  3.9466552128015213`*^9, 3.9466552981756697`*^9, 3.94665536818008*^9, 
  3.9466555460793257`*^9, 3.946655759694441*^9, 3.946655933323885*^9, 
  3.9466566711902742`*^9, 3.946657367261475*^9, 3.946657619077197*^9, 
  3.94665785880219*^9, 3.946657986520665*^9, 3.946658146224063*^9, 
  3.946658241663863*^9, 3.94665843784485*^9, 3.946658515901559*^9, 
  3.946661203256927*^9, 3.946661569467373*^9, 3.946661627870616*^9, 
  3.9466630974855423`*^9},
 CellLabel->
  "During evaluation of \
In[416]:=",ExpressionUUID->"a0d8fada-e16b-417e-b53f-2afbd8265792"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   InterpretationBox[
    ButtonBox[
     StyleBox[
      TemplateBox[{
        SubscriptBox["\"\[InvisiblePrefixScriptBase]\"", "4"], 
        SubscriptBox["\"sol\"", 
         TemplateBox[{"1"}, "RowDefault"]]},
       "RowDefault"],
      StripOnInput->False,
      FontColor->RGBColor[0, 0, 1]],
     Appearance->"Palette",
     ButtonFunction:>AceGen`SMSButtonFunction["", {416, 22, 4}],
     Evaluator->Automatic,
     FrameMargins->None,
     ImageMargins->None,
     ImageSize->All,
     Method->"Preemptive"],
    AceGen`$V[22, 4]], ",", 
   InterpretationBox[
    ButtonBox[
     StyleBox[
      TemplateBox[{
        SubscriptBox["\"\[InvisiblePrefixScriptBase]\"", "4"], 
        SubscriptBox["\"sol\"", 
         TemplateBox[{"2"}, "RowDefault"]]},
       "RowDefault"],
      StripOnInput->False,
      FontColor->RGBColor[0, 0, 1]],
     Appearance->"Palette",
     ButtonFunction:>AceGen`SMSButtonFunction["", {416, 23, 4}],
     Evaluator->Automatic,
     FrameMargins->None,
     ImageMargins->None,
     ImageSize->All,
     Method->"Preemptive"],
    AceGen`$V[23, 4]]}], "}"}]], "Output",
 CellChangeTimes->{3.9466544098297*^9, 3.946654468143917*^9, 
  3.9466545483495207`*^9, 3.946654900929481*^9, 3.946655059660749*^9, 
  3.9466552132168427`*^9, 3.946655298433709*^9, 3.946655368350498*^9, 
  3.946655546247744*^9, 3.946655759821279*^9, 3.9466559334283524`*^9, 
  3.946656671331702*^9, 3.946657367411872*^9, 3.946657619229007*^9, 
  3.946657858901002*^9, 3.946657986632169*^9, 3.9466581463217688`*^9, 
  3.946658241769821*^9, 3.946658437946377*^9, 3.946658515999565*^9, 
  3.946661203409202*^9, 3.9466615696246977`*^9, 3.946661628019184*^9, 
  3.9466630976409283`*^9},
 CellLabel->
  "Out[416]=",ExpressionUUID->"03d34637-8aa3-4765-822f-3631edf1d99f"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"SMSExport", "[", 
   RowBox[{"solution", ",", "solution$$"}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"SMSWrite", "[", 
   RowBox[{
    RowBox[{"\"\<IncludeHeaders\>\"", "->", 
     RowBox[{"{", "\"\<utilities.h\>\"", "}"}]}], ",", 
    RowBox[{"\"\<Splice\>\"", "->", 
     RowBox[{"{", 
      RowBox[{"\"\<subproblem.c\>\"", ",", " ", "\"\<utilities.c\>\""}], 
      "}"}]}]}], "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.944582395012553*^9, 3.9445824008847165`*^9}, {
   3.9445824327863197`*^9, 3.94458249360233*^9}, {3.944582591394967*^9, 
   3.9445826707381*^9}, {3.9445828626916385`*^9, 3.9445829920803623`*^9}, {
   3.9445830234749203`*^9, 3.944583023616292*^9}, {3.9445830721145554`*^9, 
   3.944583089008497*^9}, {3.944585458628723*^9, 3.944585572650257*^9}, {
   3.944585620322979*^9, 3.944585671684211*^9}, {3.9445860462699566`*^9, 
   3.944586052073522*^9}, {3.9445872219536963`*^9, 3.94458738647931*^9}, {
   3.9445874540791636`*^9, 3.9445874575660286`*^9}, {3.944588319080059*^9, 
   3.944588325189089*^9}, {3.944588539261174*^9, 3.9445885484766583`*^9}, {
   3.9445889419247684`*^9, 3.944588977475665*^9}, {3.9445894360276256`*^9, 
   3.9445894418260098`*^9}, {3.9445895289954185`*^9, 
   3.9445895342663774`*^9}, {3.9445895905472546`*^9, 3.94458959076863*^9}, 
   3.94458972596357*^9, {3.944590137939025*^9, 3.9445901567519865`*^9}, {
   3.9445902392416983`*^9, 3.944590249567762*^9}, {3.9445903209200954`*^9, 
   3.944590336311578*^9}, {3.9445903908264294`*^9, 3.944590422015356*^9}, {
   3.944591188278614*^9, 3.9445911941095533`*^9}, 3.944591715317357*^9, {
   3.9445918224610567`*^9, 3.9445918227721705`*^9}, {3.9447572037147903`*^9, 
   3.944757488584672*^9}, {3.9447575811212535`*^9, 3.9447575919133244`*^9}, 
   3.9447579046714993`*^9, {3.9447579850323253`*^9, 3.944758023766347*^9}, {
   3.944758342043431*^9, 3.944758403950558*^9}, {3.9447595987656918`*^9, 
   3.9447596001312156`*^9}, {3.9447602345647573`*^9, 
   3.9447602389630527`*^9}, {3.944760601876239*^9, 3.944760653273938*^9}, {
   3.9447607287629004`*^9, 3.9447607292534637`*^9}, {3.9447607966433434`*^9, 
   3.9447607973694515`*^9}, {3.946482340081848*^9, 3.946482366596211*^9}, {
   3.946482639793852*^9, 3.946482870217704*^9}, {3.946482967634367*^9, 
   3.9464831301372766`*^9}, {3.946483165780672*^9, 3.94648324171203*^9}, {
   3.94648343509971*^9, 3.946483537071636*^9}, {3.946483575759655*^9, 
   3.9464835809509172`*^9}, {3.946483611881505*^9, 3.9464836156468363`*^9}, {
   3.946483701222746*^9, 3.946483767279086*^9}, {3.946484287151932*^9, 
   3.946484326221816*^9}, {3.946484446656472*^9, 3.946484471854545*^9}, {
   3.946484857335958*^9, 3.946484880526752*^9}, {3.946485012207767*^9, 
   3.946485015139759*^9}, 3.946485093481909*^9, {3.946485804252454*^9, 
   3.946485839740264*^9}, {3.946486482183919*^9, 3.946486574374709*^9}, {
   3.946486644208784*^9, 3.946486654446877*^9}, {3.946486877386443*^9, 
   3.94648687830376*^9}, 3.946487003858149*^9, {3.9464870712899513`*^9, 
   3.946487124737178*^9}, {3.9464871760424137`*^9, 3.946487179289963*^9}, {
   3.9464872892541018`*^9, 3.9464873500519133`*^9}, {3.946487380269559*^9, 
   3.946487380899185*^9}, 3.9464874150194187`*^9, {3.94648783534308*^9, 
   3.946487906836109*^9}, {3.946488172145102*^9, 3.946488173766425*^9}, {
   3.946488237250154*^9, 3.946488245111073*^9}, {3.946488341546872*^9, 
   3.946488407647402*^9}, {3.94648848509734*^9, 3.946488515909651*^9}, {
   3.946488795341139*^9, 3.946488803108308*^9}, 3.946488853397708*^9, {
   3.946489810417493*^9, 3.946489829016287*^9}, {3.946490304358346*^9, 
   3.946490308724102*^9}, {3.946490352622755*^9, 3.946490358972327*^9}, {
   3.946490472306727*^9, 3.946490497352553*^9}, {3.946490816714511*^9, 
   3.946490875737713*^9}, {3.946491103187711*^9, 3.946491104496374*^9}, {
   3.9464911523399277`*^9, 3.946491153400877*^9}, 3.946545725468142*^9, {
   3.946547693093314*^9, 3.9465476992299147`*^9}, {3.946548471848366*^9, 
   3.946548493753489*^9}, {3.9465485878882523`*^9, 3.94654858964156*^9}, 
   3.9465581821337748`*^9, {3.946559193919379*^9, 3.946559208374893*^9}, {
   3.9465595683449306`*^9, 3.946559596014286*^9}, {3.946559680540257*^9, 
   3.9465597067661333`*^9}, {3.9465597719428043`*^9, 3.946559785606216*^9}, {
   3.946561220901621*^9, 3.946561222483467*^9}, {3.946562051171575*^9, 
   3.946562131651311*^9}, {3.946562318285864*^9, 3.946562324618657*^9}, {
   3.946563844091837*^9, 3.9465638557769823`*^9}, {3.9465744584954967`*^9, 
   3.946574460252626*^9}, {3.946574590141427*^9, 3.946574593852888*^9}, {
   3.946574733066743*^9, 3.946574750596258*^9}, 3.9465754590898952`*^9, {
   3.9465754912977*^9, 3.946575498482459*^9}, 3.9466507018004227`*^9, {
   3.946650950447047*^9, 3.9466509506548233`*^9}, 3.946651731245531*^9, {
   3.946653441553355*^9, 3.946653443065243*^9}, {3.946653843825601*^9, 
   3.946653986393547*^9}, {3.946654374795082*^9, 3.946654403373331*^9}},
 CellLabel->
  "In[417]:=",ExpressionUUID->"1ccf46b7-5845-4f80-9364-b10fbc616fd2"],

Cell[BoxData[
 TagBox[GridBox[{
    {
     TemplateBox[{
       StyleBox["\"File: \"", Bold, 
        RGBColor[0, 0, 1], StripOnInput -> False], 
       "\"SubproblemAceGenTest.c\"", 
       StyleBox["\"  Size: \"", Bold, 
        RGBColor[0, 0, 1], StripOnInput -> False], "16000", 
       StyleBox["\"  Time: \"", Bold, 
        RGBColor[0, 0, 1], StripOnInput -> False], "2"},
      "RowDefault"]},
    {
     TagBox[GridBox[{
        {
         StyleBox["\<\"Method\"\>",
          StripOnInput->False,
          LineColor->RGBColor[0, 0, 1],
          FrontFaceColor->RGBColor[0, 0, 1],
          BackFaceColor->RGBColor[0, 0, 1],
          GraphicsColor->RGBColor[0, 0, 1],
          FontWeight->Bold,
          FontColor->RGBColor[0, 0, 1]], 
         StyleBox["\<\"SubproblemAceGenTest\"\>",
          StripOnInput->False,
          LineColor->RGBColor[0, 0, 1],
          FrontFaceColor->RGBColor[0, 0, 1],
          BackFaceColor->RGBColor[0, 0, 1],
          GraphicsColor->RGBColor[0, 0, 1],
          FontColor->RGBColor[0, 0, 1]]},
        {
         StyleBox["\<\"No.Formulae\"\>",
          StripOnInput->False,
          LineColor->RGBColor[0, 0, 1],
          FrontFaceColor->RGBColor[0, 0, 1],
          BackFaceColor->RGBColor[0, 0, 1],
          GraphicsColor->RGBColor[0, 0, 1],
          FontWeight->Bold,
          FontColor->RGBColor[0, 0, 1]], "127"},
        {
         StyleBox["\<\"No.Leafs\"\>",
          StripOnInput->False,
          LineColor->RGBColor[0, 0, 1],
          FrontFaceColor->RGBColor[0, 0, 1],
          BackFaceColor->RGBColor[0, 0, 1],
          GraphicsColor->RGBColor[0, 0, 1],
          FontWeight->Bold,
          FontColor->RGBColor[0, 0, 1]], "862"}
       },
       AutoDelete->False,
       GridBoxAlignment->{"Columns" -> {{Left}}, "Rows" -> {{Center}}},
       GridBoxDividers->{"Columns" -> {True, True}},
       GridBoxFrame->{"ColumnsIndexed" -> {{{1, -1}, {1, -1}} -> True}},
       GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
      "Grid"]}
   },
   DefaultBaseStyle->"Column",
   GridBoxAlignment->{"Columns" -> {{Left}}},
   GridBoxDividers->{"Rows" -> {True, True}},
   GridBoxFrame->{"Columns" -> False, "Rows" -> False},
   GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
  "Column"]], "Print",
 CellChangeTimes->{{3.94458566720887*^9, 3.944585673893199*^9}, 
   3.9445860549590435`*^9, 3.944587391406229*^9, 3.944587462361335*^9, 
   3.9445883364733095`*^9, 3.9445885606571627`*^9, 3.944588981174086*^9, 
   3.944589111869343*^9, 3.9445892255109463`*^9, 3.944589311798526*^9, 
   3.9445893524473987`*^9, 3.9445894491360083`*^9, 3.9445895447349358`*^9, 
   3.9445895985352287`*^9, {3.9445897299111304`*^9, 3.9445897393185215`*^9}, 
   3.9445901654320903`*^9, 3.944590344298279*^9, 3.9445904306984997`*^9, {
   3.9445911662271595`*^9, 3.94459119597519*^9}, 3.9445917199447203`*^9, 
   3.9445918314850035`*^9, {3.9447574474111733`*^9, 3.9447574930692043`*^9}, 
   3.944757601656103*^9, 3.9447580380886197`*^9, 3.9447584117181015`*^9, 
   3.944759611748519*^9, 3.944760241694913*^9, 3.944760613628791*^9, 
   3.9447606645802083`*^9, 3.944760732040681*^9, 3.944760799856638*^9, 
   3.9464832597793503`*^9, 3.9464835423003817`*^9, 3.946483583776991*^9, 
   3.946483617310557*^9, {3.946483711895604*^9, 3.946483725283203*^9}, 
   3.946483768854479*^9, {3.946484302269731*^9, 3.946484328146948*^9}, {
   3.946484450984624*^9, 3.946484462955461*^9}, {3.9464848459991198`*^9, 
   3.94648488303067*^9}, 3.946484972415428*^9, {3.946485021132452*^9, 
   3.9464850408584433`*^9}, 3.946485113000145*^9, {3.9464855733101788`*^9, 
   3.946485586021407*^9}, 3.946485662261731*^9, 3.946485704404513*^9, 
   3.946485799041788*^9, 3.946485842173436*^9, 3.946485974574871*^9, 
   3.946486090851879*^9, 3.946486324311335*^9, {3.9464864858058033`*^9, 
   3.946486511988669*^9}, 3.9464865763630342`*^9, {3.9464866481666813`*^9, 
   3.946486656046468*^9}, 3.946486841020321*^9, 3.946486880563271*^9, {
   3.946486935329343*^9, 3.946486941724725*^9}, {3.9464869993672867`*^9, 
   3.94648700576331*^9}, {3.946487077494405*^9, 3.9464871266538754`*^9}, 
   3.9464871807797194`*^9, {3.946487317035863*^9, 3.946487356021317*^9}, 
   3.946487418907669*^9, 3.946487614128023*^9, 3.946487781856752*^9, {
   3.9464878378788023`*^9, 3.946487862341671*^9}, 3.946487926780674*^9, 
   3.946488175416217*^9, 3.946488246397908*^9, {3.946488372992395*^9, 
   3.946488410669819*^9}, 3.946488517699201*^9, {3.9464888365288057`*^9, 
   3.946488855042178*^9}, 3.946489243093528*^9, 3.946489281603278*^9, 
   3.946489479760756*^9, 3.946489520142211*^9, 3.946489651806284*^9, 
   3.94648972125696*^9, 3.946489762530616*^9, 3.946489835165392*^9, 
   3.946490197712762*^9, 3.946490249217182*^9, 3.946490310688428*^9, 
   3.946490361975287*^9, {3.946490480257773*^9, 3.9464904986340647`*^9}, 
   3.94649055168677*^9, {3.946490857654106*^9, 3.946490878174404*^9}, 
   3.946491048121232*^9, 3.9464911073444242`*^9, 3.946491155757189*^9, 
   3.946546809399185*^9, 3.946546879998178*^9, 3.946547181072674*^9, 
   3.946547276801724*^9, 3.9465474445027027`*^9, 3.946547503338316*^9, 
   3.946547543979398*^9, 3.9465477066799192`*^9, 3.94654851073906*^9, 
   3.946548592452586*^9, 3.946559227018814*^9, 3.9465593255793858`*^9, {
   3.946559579064109*^9, 3.9465596031191387`*^9}, 3.946559845337697*^9, 
   3.9465600525610743`*^9, {3.9465603331776876`*^9, 3.946560360384881*^9}, 
   3.946560696770886*^9, 3.946560796851797*^9, 3.946560942318919*^9, 
   3.946561227511701*^9, 3.9465616666663094`*^9, 3.946561995033804*^9, 
   3.946562142938479*^9, 3.946562282565213*^9, 3.946562328334594*^9, 
   3.946563862912401*^9, 3.9465653045713997`*^9, 3.946574136562553*^9, {
   3.946574449309031*^9, 3.946574462284575*^9}, 3.946574602480349*^9, {
   3.946574751868677*^9, 3.946574770816296*^9}, 3.946574905284305*^9, 
   3.946574977455681*^9, 3.946575436180235*^9, 3.946575466680822*^9, 
   3.9465755136009407`*^9, {3.94665403364181*^9, 3.946654049817946*^9}, 
   3.9466541315963507`*^9, 3.946654242414915*^9, {3.946654363550954*^9, 
   3.9466543821887913`*^9}, 3.9466553993089437`*^9, 3.946655549241003*^9, 
   3.946655766435618*^9, 3.9466559364766703`*^9, 3.946656673463271*^9, 
   3.946657370528706*^9, 3.9466576226867*^9, 3.946657859376424*^9, 
   3.94665798716575*^9, 3.946658146815796*^9, 3.946658242280469*^9, 
   3.9466584384512587`*^9, 3.946658518039435*^9, 3.946661206795516*^9, 
   3.9466615709802*^9, 3.946661628614788*^9, 3.946663098176194*^9},
 CellLabel->
  "During evaluation of \
In[417]:=",ExpressionUUID->"4f6d1d74-0f87-45cb-aec4-ba73493f9994"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"SMSInstallMathLink", "[", 
  RowBox[{"\"\<SubproblemAceGenTest\>\"", ",", 
   RowBox[{"\"\<Console\>\"", "->", "True"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.9464851508909273`*^9, 3.946485155951614*^9}, {
   3.9464856982317247`*^9, 3.9464856994189663`*^9}, 3.946486490326831*^9, {
   3.946486992680133*^9, 3.946486996586924*^9}, {3.946558331093111*^9, 
   3.9465583646122704`*^9}},
 CellLabel->
  "In[157]:=",ExpressionUUID->"e6351e52-d936-4b24-a9de-7b6a6a19b663"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   TagBox[
    RowBox[{"SMSSetLinkOption", "[", 
     RowBox[{"\<\"SubproblemAceGenTest\"\>", ",", 
      RowBox[{"{", 
       RowBox[{"i_Integer", ",", "j_Integer"}], "}"}]}], "]"}],
    HoldForm], ",", 
   TagBox[
    RowBox[{"SMSLinkNoEvaluations", "[", "\<\"SubproblemAceGenTest\"\>", "]"}],
    HoldForm], ",", 
   TagBox[
    RowBox[{"SubproblemAceGenTest", "[", 
     RowBox[{"solution_", "?", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"ArrayQ", "[", 
          RowBox[{"#1", ",", "1", ",", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"Head", "[", "#1", "]"}], "\[Equal]", "Real"}], "||", 
             RowBox[{
              RowBox[{"Head", "[", "#1", "]"}], "\[Equal]", "Integer"}]}], 
            "&"}]}], "]"}], "&&", 
         RowBox[{
          RowBox[{"Dimensions", "[", "#1", "]"}], "===", 
          RowBox[{"{", "2", "}"}]}]}], "&"}], ")"}]}], "]"}],
    HoldForm]}], "}"}]], "Output",
 CellChangeTimes->{
  3.9445890800824175`*^9, 3.9445891548323936`*^9, 3.944589310817481*^9, 
   3.9445894461207623`*^9, 3.94458953883762*^9, {3.9445895940534563`*^9, 
   3.9445896065844693`*^9}, 3.9445897460435853`*^9, 3.9445898734074545`*^9, 
   3.94459017619863*^9, 3.9445903523386154`*^9, 3.944590437579979*^9, 
   3.944591171145282*^9, 3.946485030887744*^9, 3.946485157947221*^9, {
   3.946485575755114*^9, 3.9464855899337187`*^9}, 3.946485665535763*^9, {
   3.94648570083011*^9, 3.946485706039772*^9}, 3.94648580115936*^9, 
   3.94648584413938*^9, 3.946485978073834*^9, 3.94648609364375*^9, 
   3.9464863353132877`*^9, {3.946486492732561*^9, 3.946486514015867*^9}, 
   3.946486580688645*^9, 3.946486658975609*^9, 3.9464868432784452`*^9, 
   3.9464868830924377`*^9, {3.946486937423141*^9, 3.9464869442296677`*^9}, {
   3.946487001566353*^9, 3.946487009281196*^9}, {3.94648710467247*^9, 
   3.946487129105879*^9}, 3.9464871838878593`*^9, {3.946487320035198*^9, 
   3.9464873590887527`*^9}, 3.946487421434359*^9, 3.9464876172921352`*^9, 
   3.946487784265923*^9, {3.946487841644668*^9, 3.946487865495576*^9}, 
   3.946487931491787*^9, 3.946488179783915*^9, 3.9464882519609737`*^9, {
   3.9464883769211397`*^9, 3.9464884142225018`*^9}, 3.9464885223296328`*^9, {
   3.946488840260323*^9, 3.9464888572090197`*^9}, 3.946488894452127*^9, 
   3.94648924699973*^9, 3.946489284191044*^9, 3.946489481752924*^9, 
   3.9464895222236*^9, 3.946489655135803*^9, 3.946489722985387*^9, 
   3.946489764869535*^9, 3.946490365147394*^9, {3.946490482838114*^9, 
   3.946490502515791*^9}, 3.946490554435337*^9, 3.9464910514967833`*^9, 
   3.946491114273307*^9, 3.946491161006543*^9, 3.9465477113100367`*^9, 
   3.946548516570466*^9, 3.9465485962633047`*^9, {3.946558340175748*^9, 
   3.946558365563363*^9}, 3.946559612776732*^9, 3.94655985582664*^9, 
   3.9465599777852583`*^9, 3.946560058566016*^9, 3.9465608025100727`*^9, {
   3.946560950382083*^9, 3.94656096471756*^9}, 3.9465612361125603`*^9, 
   3.94656167619271*^9, 3.94656201506962*^9, 3.946562151075069*^9, 
   3.9465622897163143`*^9},
 CellLabel->
  "Out[157]=",ExpressionUUID->"1beb13af-2bcb-4241-aeee-91e10a613b47"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"wynik", "=", 
  RowBox[{"SubproblemAceGenTest", "[", 
   RowBox[{"{", 
    RowBox[{"10000.2", ",", "1000.2"}], "}"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.9464879967575493`*^9, 3.946487996843725*^9}, {
   3.946488092925734*^9, 3.9464881394536467`*^9}, {3.9464882770715437`*^9, 
   3.946488282607798*^9}, {3.946547726904228*^9, 3.946547737415663*^9}, {
   3.9465598708308067`*^9, 3.946559882188877*^9}, {3.946560066358405*^9, 
   3.94656010938269*^9}, {3.946560813603545*^9, 3.946560836395156*^9}, {
   3.946562159021884*^9, 3.9465621815381203`*^9}, 3.946562293602646*^9},
 CellLabel->
  "In[160]:=",ExpressionUUID->"6d88ac9e-8175-471b-8759-4eda14ff303f"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"2050.9458910665485`", ",", "205.13150539436856`"}], 
  "}"}]], "Output",
 CellChangeTimes->{
  3.946488284449422*^9, {3.946488381069251*^9, 3.946488418137946*^9}, 
   3.94648852659702*^9, 3.9464888991297693`*^9, 3.9464910866292562`*^9, 
   3.946491118598399*^9, 3.9464911672417917`*^9, 3.946491837687388*^9, 
   3.946547739160246*^9, 3.946548521145632*^9, 3.946548599959517*^9, 
   3.946558377151335*^9, {3.946559239570036*^9, 3.9465592595273037`*^9}, 
   3.946559620713993*^9, {3.946559862510316*^9, 3.9465598833402233`*^9}, 
   3.946559982250607*^9, {3.946560061947687*^9, 3.946560110482785*^9}, {
   3.9465608072683487`*^9, 3.946560837360209*^9}, {3.946560958534336*^9, 
   3.946560968224751*^9}, 3.9465612397118196`*^9, 3.946561678785872*^9, 
   3.946562017631476*^9, {3.9465621562412643`*^9, 3.9465621824011593`*^9}, {
   3.946562291950254*^9, 3.946562297699572*^9}},
 CellLabel->
  "Out[160]=",ExpressionUUID->"3f466d7e-1e03-4d89-869f-2ecb9b10ddf4"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"SMSUninstallMathLink", "[", "]"}], ";"}]], "Input",
 CellLabel->
  "In[116]:=",ExpressionUUID->"ec206e4a-d101-4104-ac7f-8a1ce9f37e51"]
}, Open  ]]
},
WindowSize->{1283.25, 743.25},
WindowMargins->{{-2.25, Automatic}, {Automatic, -22.5}},
FrontEndVersion->"14.1 for Linux x86 (64-bit) (July 16, 2024)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"fcbe0d31-3f4a-41ab-b734-6e96c1dc1c77"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 213, 3, 29, "Input",ExpressionUUID->"927a0af1-6d07-4841-a4de-3ec128879900"],
Cell[796, 27, 404, 6, 33, "Output",ExpressionUUID->"fc3499e5-9f96-4a51-956a-ccf309f64150"]
}, Open  ]],
Cell[CellGroupData[{
Cell[1237, 38, 252, 4, 29, "Input",ExpressionUUID->"7c76c145-1f51-40ec-87db-d42ea99550cc"],
Cell[1492, 44, 406, 6, 33, "Output",ExpressionUUID->"bdb8f08d-00f1-47cc-9784-2030c28daa65"]
}, Open  ]],
Cell[CellGroupData[{
Cell[1935, 55, 238, 4, 43, "Subsubsection",ExpressionUUID->"5af5aef7-6e4f-4ee3-b3dc-cd5bcaee2ee4"],
Cell[2176, 61, 2149, 50, 135, "Input",ExpressionUUID->"b76dce2c-179c-41ac-9cdf-9703c9eb6d1b"],
Cell[4328, 113, 1445, 35, 133, "Input",ExpressionUUID->"9d09b268-7081-4bd4-a59f-dc34772c3b59"],
Cell[5776, 150, 1428, 35, 133, "Input",ExpressionUUID->"9af1e659-a6ce-408f-99b8-50d46e96b2c3"],
Cell[7207, 187, 1814, 42, 129, "Input",ExpressionUUID->"de2bd003-32bb-493b-b4a0-2420c3688d6b"],
Cell[9024, 231, 1385, 34, 109, "Input",ExpressionUUID->"cebd3a71-bb0c-4cf5-9cba-3fddca3243f9"]
}, Closed]],
Cell[CellGroupData[{
Cell[10446, 270, 175, 3, 35, "Subsubsection",ExpressionUUID->"e80f8db0-b2b1-4e23-a1f9-bc6824d22812"],
Cell[10624, 275, 10348, 207, 1234, "Input",ExpressionUUID->"d232c276-3a17-4009-913c-0d0c062189cb"]
}, Open  ]],
Cell[CellGroupData[{
Cell[21009, 487, 252, 4, 43, "Subsubsection",ExpressionUUID->"872f6898-a059-4890-87b8-4d071f622507"],
Cell[21264, 493, 9160, 175, 810, "Input",ExpressionUUID->"570334ca-de98-4b8a-ae79-30bf47b13425"]
}, Open  ]],
Cell[CellGroupData[{
Cell[30461, 673, 164, 3, 43, "Subsubsection",ExpressionUUID->"7ecbfff5-2f28-4a02-817c-2f990e07c10d"],
Cell[30628, 678, 976, 31, 69, "Input",ExpressionUUID->"aaf70963-0479-45ba-a12b-c57521e33eb3"],
Cell[31607, 711, 6033, 170, 369, "Input",ExpressionUUID->"b9a07afc-9bc0-4c84-81b4-8a1d9d5ee6ad"],
Cell[37643, 883, 3780, 54, 29, "Input",ExpressionUUID->"5c4a5128-1846-4400-b5e2-68b67b525d38"],
Cell[41426, 939, 5395, 86, 91, "Input",ExpressionUUID->"bde6b50e-1de4-417a-96b9-97ba03a855da"],
Cell[46824, 1027, 6120, 107, 149, "Input",ExpressionUUID->"32ae89f9-eeb0-484e-8d24-6c0eb1dfa651"],
Cell[CellGroupData[{
Cell[52969, 1138, 5167, 79, 49, "Input",ExpressionUUID->"ec5fdf19-ec11-4493-8151-b0f4293986c5"],
Cell[58139, 1219, 742, 12, 23, "Print",ExpressionUUID->"a0d8fada-e16b-417e-b53f-2afbd8265792"],
Cell[58884, 1233, 1814, 49, 38, "Output",ExpressionUUID->"03d34637-8aa3-4765-822f-3631edf1d99f"]
}, Open  ]],
Cell[CellGroupData[{
Cell[60735, 1287, 5032, 76, 51, "Input",ExpressionUUID->"1ccf46b7-5845-4f80-9364-b10fbc616fd2"],
Cell[65770, 1365, 6617, 122, 81, "Print",ExpressionUUID->"4f6d1d74-0f87-45cb-aec4-ba73493f9994"]
}, Open  ]],
Cell[CellGroupData[{
Cell[72424, 1492, 492, 9, 29, "Input",ExpressionUUID->"e6351e52-d936-4b24-a9de-7b6a6a19b663"],
Cell[72919, 1503, 3171, 62, 53, "Output",ExpressionUUID->"1beb13af-2bcb-4241-aeee-91e10a613b47"]
}, Open  ]],
Cell[CellGroupData[{
Cell[76127, 1570, 682, 12, 29, "Input",ExpressionUUID->"6d88ac9e-8175-471b-8759-4eda14ff303f"],
Cell[76812, 1584, 995, 17, 33, "Output",ExpressionUUID->"3f466d7e-1e03-4d89-869f-2ecb9b10ddf4"]
}, Open  ]],
Cell[77822, 1604, 169, 4, 29, "Input",ExpressionUUID->"ec206e4a-d101-4104-ac7f-8a1ce9f37e51"]
}, Open  ]]
}
]
*)

