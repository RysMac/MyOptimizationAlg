(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 13.2' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     47390,       1059]
NotebookOptionsPosition[     44520,       1002]
NotebookOutlinePosition[     44923,       1018]
CellTagsIndexPosition[     44880,       1015]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell[BoxData[
 RowBox[{"NotebookDirectory", "[", "]"}]], "Input",
 CellChangeTimes->{{3.9445819290941925`*^9, 3.9445819376085052`*^9}},
 CellLabel->"In[2]:=",ExpressionUUID->"927a0af1-6d07-4841-a4de-3ec128879900"],

Cell[BoxData["\<\"/home/mr/job-related/MyOptimizationAlg/src/algorithms/\"\>"]\
, "Output",
 CellChangeTimes->{{3.9445819348847747`*^9, 3.944581938156715*^9}, 
   3.9445823860043507`*^9, 3.944585608471959*^9, 3.944752596943486*^9, 
   3.946482353610509*^9, 3.946485652539456*^9, 3.946486313030821*^9, 
   3.94654679578878*^9},
 CellLabel->"Out[2]=",ExpressionUUID->"fc3499e5-9f96-4a51-956a-ccf309f64150"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"SetDirectory", "[", 
  RowBox[{"NotebookDirectory", "[", "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.9445819109188366`*^9, 3.9445819443001957`*^9}},
 CellLabel->"In[3]:=",ExpressionUUID->"7c76c145-1f51-40ec-87db-d42ea99550cc"],

Cell[BoxData["\<\"/home/mr/job-related/MyOptimizationAlg/src/algorithms\"\>"],\
 "Output",
 CellChangeTimes->{{3.944581915091589*^9, 3.9445819455427876`*^9}, 
   3.944582387042471*^9, 3.944585610036294*^9, 3.944752598330326*^9, 
   3.946482357691633*^9, 3.946485657568273*^9, 3.9464863178100777`*^9, 
   3.9465467970987997`*^9},
 CellLabel->"Out[3]=",ExpressionUUID->"bdb8f08d-00f1-47cc-9784-2030c28daa65"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"TrustRegion", "[", 
     RowBox[{
     "fun_", ",", "grad_", ",", "hess_", ",", "deltaIn_", ",", "x0_", ",", 
      "verbose_"}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "sol", ",", "solInner", ",", "solTry", ",", "hessVal", ",", "gradVal", 
        ",", "funcVal", ",", "numerator", ",", "denominator", ",", "rho", ",",
         "fTry", ",", "delta"}], "}"}], ",", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"hessVal", "\[DoubleLeftTee]", 
        RowBox[{"hess", "[", "x0", "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"gradVal", "\[DoubleLeftTee]", 
        RowBox[{"grad", "[", "x0", "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"funcVal", "\[DoubleLeftTee]", 
        RowBox[{"fun", "[", "x0", "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"sol", "\[DoubleLeftTee]", "x0"}], ";", "\[IndentingNewLine]", 
       RowBox[{"delta", "\[DoubleLeftTee]", "deltaIn"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"SMSDo", "[", 
        RowBox[{"i", ",", "1", ",", "10000", ",", "1", ",", 
         RowBox[{"{", 
          RowBox[{
          "hessVal", ",", "gradVal", ",", "funcVal", ",", "sol", ",", 
           "delta"}], "}"}]}], "]"}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"verbose", ">", "1"}], ",", 
         RowBox[{"SMSPrint", "[", 
          RowBox[{
          "\"\<Iteration = \>\"", ",", "i", ",", "\"\<  Delta = \>\"", ",", 
           "delta", ",", " ", 
           RowBox[{"\"\<Optimal\>\"", "->", "True"}]}], "]"}]}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{"Call", " ", "Subproblem", " ", "Solver", " ", 
         RowBox[{"(", 
          RowBox[{"Assume", " ", 
           RowBox[{"it", "'"}], "s", " ", "a", " ", "separate", " ", 
           "function"}], ")"}]}], "*)"}], "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"subproblemC", "=", 
        RowBox[{"SMSCall", "[", 
         RowBox[{"\"\<subproblem\>\"", ",", "hessVal", ",", "gradVal", ",", 
          RowBox[{"Real", "[", 
           RowBox[{"sol$$", "[", "n", "]"}], "]"}], ",", "delta", ",", 
          RowBox[{"\"\<System\>\"", "->", "False"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"solInner", "\[DoubleRightTee]", 
        RowBox[{"SMSReal", "[", 
         RowBox[{
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"sol$$", "[", "si", "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"si", ",", "n"}], "}"}]}], "]"}], ",", 
          RowBox[{"\"\<Subordinate\>\"", "\[Rule]", "subproblemC"}]}], 
         "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"solTry", "\[DoubleRightTee]", 
        RowBox[{"sol", "+", "solInner"}]}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"fTry", "\[DoubleRightTee]", 
        RowBox[{"fun", "[", "solTry", "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{"Compute", " ", "Rho"}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{"numerator", "\[DoubleRightTee]", 
        RowBox[{"fTry", "-", "funcVal"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"denominator", "\[DoubleRightTee]", 
        RowBox[{
         RowBox[{"gradVal", ".", "solInner"}], "+", 
         RowBox[{"0.5", " ", 
          RowBox[{"solInner", ".", "hessVal", ".", "solInner"}]}]}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"SMSIf", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"SMSAbs", "[", "numerator", "]"}], "<", 
          RowBox[{"10", "^", 
           RowBox[{"-", "16"}]}]}], "&&", 
         RowBox[{
          RowBox[{"SMSAbs", "[", 
           RowBox[{"numerator", "-", "denominator"}], "]"}], "<", 
          RowBox[{"10", "^", 
           RowBox[{"-", "16"}]}]}]}], "]"}], ";", "\[IndentingNewLine]", "\t", 
       RowBox[{"rho", "\[DoubleLeftTee]", "1"}], ";", "\[IndentingNewLine]", 
       RowBox[{"SMSElse", "[", "]"}], ";", "\[IndentingNewLine]", "\t", 
       RowBox[{"rho", "\[LeftTee]", 
        RowBox[{"numerator", "/", "denominator"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"SMSEndIf", "[", "rho", "]"}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"verbose", ">", "1"}], ",", 
         RowBox[{"SMSPrint", "[", 
          RowBox[{
          "\"\<Rho = \>\"", ",", "rho", ",", "\"\< Numerator = \>\"", ",", 
           "numerator", ",", "\"\< Denominator = \>\"", ",", "denominator", 
           ",", " ", 
           RowBox[{"\"\<Optimal\>\"", "->", "True"}]}], "]"}]}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{"Update", " ", "Solution"}], "*)"}], "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"SMSIf", "[", 
        RowBox[{"rho", ">", "0.2"}], "]"}], ";", "\[IndentingNewLine]", "\t", 
       RowBox[{"sol", "\[LeftTee]", "solTry"}], ";", "\[IndentingNewLine]", 
       "\t", 
       RowBox[{"funcVal", "\[LeftTee]", 
        RowBox[{"fun", "[", "sol", "]"}]}], ";", "\[IndentingNewLine]", "\t", 
       RowBox[{"gradVal", "\[LeftTee]", 
        RowBox[{"grad", "[", "sol", "]"}]}], ";", "\[IndentingNewLine]", "\t", 
       RowBox[{"hessVal", "\[LeftTee]", 
        RowBox[{"hess", "[", "sol", "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"SMSEndIf", "[", 
        RowBox[{"sol", ",", " ", "funcVal", ",", "gradVal", ",", "hessVal"}], 
        "]"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"SMSIf", "[", 
        RowBox[{"rho", " ", "<", " ", 
         RowBox[{"1", "/", "4"}]}], "]"}], ";", "\[IndentingNewLine]", "\t", 
       RowBox[{"delta", "\[LeftTee]", 
        RowBox[{"delta", "/", "4"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"SMSEndIf", "[", "delta", "]"}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"SMSIf", "[", 
        RowBox[{
         RowBox[{"rho", " ", ">", " ", "0.8"}], " ", "&&", " ", 
         RowBox[{
          RowBox[{"SMSAbs", "[", 
           RowBox[{"delta", " ", "-", " ", 
            RowBox[{"Norm", "[", "sol", "]"}]}], "]"}], ">=", " ", 
          RowBox[{
           RowBox[{"10", "^", 
            RowBox[{"-", "8"}]}], "*", "delta"}]}], "&&", 
         RowBox[{"delta", "<", "10"}]}], "]"}], ";", "\[IndentingNewLine]", 
       "\t", 
       RowBox[{"delta", "\[LeftTee]", 
        RowBox[{"2", "*", "delta"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"SMSEndIf", "[", "delta", "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{"Stopping", " ", "Conditions"}], "*)"}], 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"SMSIf", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Norm", "[", "gradVal", "]"}], "<", 
          RowBox[{"10", "^", 
           RowBox[{"-", "12"}]}]}], "||", 
         RowBox[{"i", "==", "10000"}]}], "]"}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", "\t", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"verbose", ">", "0"}], ",", 
         RowBox[{"SMSPrint", "[", 
          RowBox[{"\"\<Gradient = \>\"", ",", 
           RowBox[{"Norm", "[", "gradVal", "]"}], ",", 
           "\"\<  Outer iterations = \>\"", ",", "i", ",", " ", 
           RowBox[{"\"\<Optimal\>\"", "->", "True"}]}], "]"}]}], "]"}], ";", 
       "\[IndentingNewLine]", "\t", 
       RowBox[{"SMSBreak", "[", "]"}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"SMSEndIf", "[", "]"}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"SMSEndDo", "[", "sol", "]"}], ";", "\[IndentingNewLine]", 
       "sol"}]}], "\[IndentingNewLine]", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}]], "Input",
 CellChangeTimes->{{3.9465444479977083`*^9, 3.946544483501905*^9}, {
   3.946545100075551*^9, 3.946545183517581*^9}, {3.946545220550153*^9, 
   3.946545372685753*^9}, {3.946545428677854*^9, 3.946545453101589*^9}, {
   3.946545762780414*^9, 3.946545805230424*^9}, {3.9465458506223297`*^9, 
   3.946545857340954*^9}, 3.9465459256921377`*^9, {3.946546088113155*^9, 
   3.9465464112401752`*^9}, {3.9465464591476097`*^9, 3.946546467398374*^9}, {
   3.9465471472071657`*^9, 3.9465471647967453`*^9}, {3.946547224734761*^9, 
   3.946547230445859*^9}, {3.9465473079191437`*^9, 3.946547308198434*^9}, {
   3.946547383949868*^9, 3.946547388070413*^9}, {3.946547424245617*^9, 
   3.946547435676053*^9}, 3.9465474939182997`*^9, {3.9465475283094807`*^9, 
   3.9465475623569937`*^9}, {3.946547646780698*^9, 3.946547647068836*^9}, {
   3.9465595268362007`*^9, 3.946559552351368*^9}, {3.946560236781304*^9, 
   3.946560312219819*^9}, {3.946560350529196*^9, 3.946560350911776*^9}, {
   3.9465606107725487`*^9, 3.946560659965871*^9}, {3.946560744224495*^9, 
   3.9465607510640707`*^9}, {3.9465609310162687`*^9, 3.946560933143293*^9}, 
   3.9465610371521177`*^9, {3.946561613111635*^9, 3.946561616832293*^9}, {
   3.946561797487714*^9, 3.9465618159590597`*^9}, {3.946562257220179*^9, 
   3.946562260600925*^9}, {3.9465652811469383`*^9, 3.9465652828099947`*^9}, {
   3.946565356990841*^9, 3.9465653584576178`*^9}, {3.946573737150627*^9, 
   3.946573763222642*^9}, {3.9465743936730967`*^9, 3.9465744124474993`*^9}, {
   3.946574550376478*^9, 3.946574556311294*^9}, {3.9465747604394283`*^9, 
   3.946574761062989*^9}, {3.9465748947121973`*^9, 3.946574896391165*^9}, {
   3.9465749606996098`*^9, 3.946574966766774*^9}, {3.9465750490478477`*^9, 
   3.946575059615093*^9}, {3.946575421334116*^9, 
   3.9465754236714783`*^9}},ExpressionUUID->"d232c276-3a17-4009-913c-\
0d0c062189cb"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"rosenbrock", "[", 
  RowBox[{"{", 
   RowBox[{"x1", ",", "x2"}], "}"}], "]"}]], "Input",
 CellChangeTimes->{{3.9465639793518553`*^9, 3.9465639833041286`*^9}},
 CellLabel->
  "In[332]:=",ExpressionUUID->"ec95ed9e-ff0c-4551-b654-1434a7d7b059"],

Cell[BoxData[
 RowBox[{
  SuperscriptBox[
   RowBox[{"(", 
    RowBox[{"1", "-", "x1"}], ")"}], "2"], "+", 
  RowBox[{"100", " ", 
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", 
       SuperscriptBox["x1", "2"]}], "+", "x2"}], ")"}], "2"]}]}]], "Output",
 CellChangeTimes->{3.946563984692274*^9, 3.946575360354005*^9},
 CellLabel->
  "Out[332]=",ExpressionUUID->"ac164716-b349-4f6a-a802-9ec3c5bcc522"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"mm", "=", 
  RowBox[{
   RowBox[{"rosenbrockGrad", "[", 
    RowBox[{"{", 
     RowBox[{"1", ",", "1"}], "}"}], "]"}], "//", "FullSimplify"}]}]], "Input",
 CellChangeTimes->{{3.946564022791946*^9, 3.9465640458160677`*^9}, {
  3.94657536386866*^9, 3.946575406403369*^9}},
 CellLabel->
  "In[337]:=",ExpressionUUID->"f36e14c8-3f7a-42da-809e-d6a0d4e982ea"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0.`", ",", "0.`"}], "}"}]], "Output",
 CellChangeTimes->{{3.946564027673967*^9, 3.946564046593223*^9}, {
  3.946575367098102*^9, 3.946575407139805*^9}},
 CellLabel->
  "Out[337]=",ExpressionUUID->"02d470cf-a34f-47af-a940-6027f5cdb4eb"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData["mm"], "Input",
 CellChangeTimes->{{3.9465754084457197`*^9, 3.946575408617997*^9}},
 CellLabel->
  "In[338]:=",ExpressionUUID->"809862d6-3841-434c-8020-b9fa23161e55"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0.`", ",", "0.`"}], "}"}]], "Output",
 CellChangeTimes->{3.946575409312002*^9},
 CellLabel->
  "Out[338]=",ExpressionUUID->"37a0db9a-3980-4559-8127-8bb55d4803af"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"rosenbrockHess", "[", 
   RowBox[{"{", 
    RowBox[{"x1", ",", "x2"}], "}"}], "]"}], "//", "MatrixForm"}]], "Input",
 CellChangeTimes->{{3.9465642870550528`*^9, 3.9465642965694647`*^9}},
 CellLabel->
  "In[190]:=",ExpressionUUID->"6c20ee66-23ff-41e8-9ff1-5dce664d7cf4"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      RowBox[{"2.`", "\[VeryThinSpace]", "+", 
       RowBox[{"1200", " ", 
        SuperscriptBox["x1", "2"]}], "-", 
       RowBox[{"400", " ", "x2"}]}], 
      RowBox[{"0.`", "\[VeryThinSpace]", "-", 
       RowBox[{"400", " ", "x1"}]}]},
     {
      RowBox[{"0.`", "\[VeryThinSpace]", "-", 
       RowBox[{"400", " ", "x1"}]}], "200.`"}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{3.946564297369885*^9},
 CellLabel->
  "Out[190]//MatrixForm=",ExpressionUUID->"7f69582a-30b7-4b0e-b5d8-\
02010b5db66c"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"Define", " ", "the", " ", "Rosenbrock", " ", "function"}], "*)"}],
   "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"rosenbrock", "[", "x_", "]"}], ":=", 
     RowBox[{"Sum", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"100", " ", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"x", "[", 
             RowBox[{"[", 
              RowBox[{"i", "+", "1"}], "]"}], "]"}], "-", 
            RowBox[{
             RowBox[{"x", "[", 
              RowBox[{"[", "i", "]"}], "]"}], "^", "2"}]}], ")"}], "^", 
          "2"}]}], "+", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"1", "-", 
           RowBox[{"x", "[", 
            RowBox[{"[", "i", "]"}], "]"}]}], ")"}], "^", "2"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", 
         RowBox[{
          RowBox[{"Length", "[", "x", "]"}], "-", "1"}]}], "}"}]}], "]"}]}], 
    ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "Gradient", " ", "of", " ", "the", " ", "Rosenbrock", " ", "function"}], 
    "*)"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"rosenbrockGrad", "[", "x_", "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"n", "=", 
          RowBox[{"Length", "[", "x", "]"}]}], ",", "grad"}], "}"}], ",", 
       RowBox[{
        RowBox[{"grad", "=", 
         RowBox[{"ConstantArray", "[", 
          RowBox[{"0.0", ",", "n"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"For", "[", 
         RowBox[{
          RowBox[{"i", "=", "1"}], ",", 
          RowBox[{"i", "<=", 
           RowBox[{"n", "-", "1"}]}], ",", 
          RowBox[{"i", "++"}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"grad", "[", 
             RowBox[{"[", "i", "]"}], "]"}], "+=", 
            RowBox[{
             RowBox[{
              RowBox[{"-", "400"}], " ", 
              RowBox[{"x", "[", 
               RowBox[{"[", "i", "]"}], "]"}], " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"x", "[", 
                 RowBox[{"[", 
                  RowBox[{"i", "+", "1"}], "]"}], "]"}], "-", 
                RowBox[{
                 RowBox[{"x", "[", 
                  RowBox[{"[", "i", "]"}], "]"}], "^", "2"}]}], ")"}]}], "-", 
             RowBox[{"2", " ", 
              RowBox[{"(", 
               RowBox[{"1", "-", 
                RowBox[{"x", "[", 
                 RowBox[{"[", "i", "]"}], "]"}]}], ")"}]}]}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"grad", "[", 
             RowBox[{"[", 
              RowBox[{"i", "+", "1"}], "]"}], "]"}], "+=", 
            RowBox[{"200", " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"x", "[", 
                RowBox[{"[", 
                 RowBox[{"i", "+", "1"}], "]"}], "]"}], "-", 
               RowBox[{
                RowBox[{"x", "[", 
                 RowBox[{"[", "i", "]"}], "]"}], "^", "2"}]}], ")"}]}]}], 
           ";"}]}], "]"}], ";", "\[IndentingNewLine]", "grad"}]}], 
      "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", "\n", 
   RowBox[{"(*", 
    RowBox[{
    "Hessian", " ", "of", " ", "the", " ", "Rosenbrock", " ", "function"}], 
    "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"rosenbrockHess", "[", "x_", "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"n", "=", 
          RowBox[{"Length", "[", "x", "]"}]}], ",", "hess"}], "}"}], ",", 
       RowBox[{
        RowBox[{"hess", "=", 
         RowBox[{"ConstantArray", "[", 
          RowBox[{"0.0", ",", 
           RowBox[{"{", 
            RowBox[{"n", ",", "n"}], "}"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"For", "[", 
         RowBox[{
          RowBox[{"i", "=", "1"}], ",", 
          RowBox[{"i", "<=", 
           RowBox[{"n", "-", "1"}]}], ",", 
          RowBox[{"i", "++"}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"hess", "[", 
             RowBox[{"[", 
              RowBox[{"i", ",", "i"}], "]"}], "]"}], "+=", 
            RowBox[{
             RowBox[{"1200", " ", 
              RowBox[{
               RowBox[{"x", "[", 
                RowBox[{"[", "i", "]"}], "]"}], "^", "2"}]}], "-", 
             RowBox[{"400", " ", 
              RowBox[{"x", "[", 
               RowBox[{"[", 
                RowBox[{"i", "+", "1"}], "]"}], "]"}]}], "+", "2"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"hess", "[", 
             RowBox[{"[", 
              RowBox[{"i", ",", 
               RowBox[{"i", "+", "1"}]}], "]"}], "]"}], "+=", 
            RowBox[{
             RowBox[{"-", "400"}], " ", 
             RowBox[{"x", "[", 
              RowBox[{"[", "i", "]"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"hess", "[", 
             RowBox[{"[", 
              RowBox[{
               RowBox[{"i", "+", "1"}], ",", "i"}], "]"}], "]"}], "+=", 
            RowBox[{
             RowBox[{"-", "400"}], " ", 
             RowBox[{"x", "[", 
              RowBox[{"[", "i", "]"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"hess", "[", 
             RowBox[{"[", 
              RowBox[{
               RowBox[{"i", "+", "1"}], ",", 
               RowBox[{"i", "+", "1"}]}], "]"}], "]"}], "+=", "200"}], 
           ";"}]}], "]"}], ";", "\[IndentingNewLine]", "hess"}]}], "]"}]}], 
    ";"}]}]}]], "Input",
 CellChangeTimes->{{3.946548430119348*^9, 3.946548433584635*^9}, 
   3.946574016919158*^9},
 CellLabel->
  "In[257]:=",ExpressionUUID->"b9a07afc-9bc0-4c84-81b4-8a1d9d5ee6ad"],

Cell[BoxData[
 RowBox[{
  RowBox[{"<<", "AceGen`"}], ";"}]], "Input",
 CellChangeTimes->{{3.944582395012553*^9, 3.9445824008847165`*^9}, {
   3.9445824327863197`*^9, 3.94458249360233*^9}, {3.944582591394967*^9, 
   3.9445826707381*^9}, {3.9445828626916385`*^9, 3.9445829920803623`*^9}, {
   3.9445830234749203`*^9, 3.944583023616292*^9}, {3.9445830721145554`*^9, 
   3.944583089008497*^9}, {3.944585458628723*^9, 3.944585572650257*^9}, {
   3.944585620322979*^9, 3.944585671684211*^9}, {3.9445860462699566`*^9, 
   3.944586052073522*^9}, {3.9445872219536963`*^9, 3.94458738647931*^9}, {
   3.9445874540791636`*^9, 3.9445874575660286`*^9}, {3.944588319080059*^9, 
   3.944588325189089*^9}, {3.944588539261174*^9, 3.9445885484766583`*^9}, {
   3.9445889419247684`*^9, 3.944588977475665*^9}, {3.9445894360276256`*^9, 
   3.9445894418260098`*^9}, {3.9445895289954185`*^9, 
   3.9445895342663774`*^9}, {3.9445895905472546`*^9, 3.94458959076863*^9}, 
   3.94458972596357*^9, {3.944590137939025*^9, 3.9445901567519865`*^9}, {
   3.9445902392416983`*^9, 3.944590249567762*^9}, {3.9445903209200954`*^9, 
   3.944590336311578*^9}, {3.9445903908264294`*^9, 3.944590422015356*^9}, {
   3.944591188278614*^9, 3.9445911941095533`*^9}, 3.944591715317357*^9, {
   3.9445918224610567`*^9, 3.9445918227721705`*^9}, {3.9447572037147903`*^9, 
   3.944757488584672*^9}, {3.9447575811212535`*^9, 3.9447575919133244`*^9}, 
   3.9447579046714993`*^9, {3.9447579850323253`*^9, 3.944758023766347*^9}, {
   3.944758342043431*^9, 3.944758403950558*^9}, {3.9447595987656918`*^9, 
   3.9447596001312156`*^9}, {3.9447602345647573`*^9, 
   3.9447602389630527`*^9}, {3.944760601876239*^9, 3.944760653273938*^9}, {
   3.9447607287629004`*^9, 3.9447607292534637`*^9}, {3.9447607966433434`*^9, 
   3.9447607973694515`*^9}, {3.946482340081848*^9, 3.946482366596211*^9}, {
   3.946482639793852*^9, 3.946482870217704*^9}, {3.946482967634367*^9, 
   3.9464831301372766`*^9}, {3.946483165780672*^9, 3.94648324171203*^9}, {
   3.94648343509971*^9, 3.946483537071636*^9}, {3.946483575759655*^9, 
   3.9464835809509172`*^9}, {3.946483611881505*^9, 3.9464836156468363`*^9}, {
   3.946483701222746*^9, 3.946483767279086*^9}, {3.946484287151932*^9, 
   3.946484326221816*^9}, {3.946484446656472*^9, 3.946484471854545*^9}, {
   3.946484857335958*^9, 3.946484880526752*^9}, {3.946485012207767*^9, 
   3.946485015139759*^9}, 3.946485093481909*^9, {3.946485804252454*^9, 
   3.946485839740264*^9}, {3.946486482183919*^9, 3.946486574374709*^9}, {
   3.946486644208784*^9, 3.946486654446877*^9}, {3.946486877386443*^9, 
   3.94648687830376*^9}, 3.946487003858149*^9, {3.9464870712899513`*^9, 
   3.946487124737178*^9}, {3.9464871760424137`*^9, 3.946487179289963*^9}, {
   3.9464872892541018`*^9, 3.9464873500519133`*^9}, {3.946487380269559*^9, 
   3.946487380899185*^9}, 3.9464874150194187`*^9, {3.94648783534308*^9, 
   3.946487906836109*^9}, {3.946488172145102*^9, 3.946488173766425*^9}, {
   3.946488237250154*^9, 3.946488245111073*^9}, {3.946488341546872*^9, 
   3.946488407647402*^9}, {3.94648848509734*^9, 3.946488515909651*^9}, {
   3.946488795341139*^9, 3.946488803108308*^9}, 3.946488853397708*^9, {
   3.946489810417493*^9, 3.946489829016287*^9}, {3.946490304358346*^9, 
   3.946490308724102*^9}, {3.946490352622755*^9, 3.946490358972327*^9}, {
   3.946490472306727*^9, 3.946490497352553*^9}, {3.946490816714511*^9, 
   3.946490875737713*^9}, {3.946491103187711*^9, 3.946491104496374*^9}, {
   3.9464911523399277`*^9, 3.946491153400877*^9}, 3.946545725468142*^9, {
   3.946547693093314*^9, 3.9465476992299147`*^9}, {3.946548471848366*^9, 
   3.946548493753489*^9}, {3.9465485878882523`*^9, 3.94654858964156*^9}, 
   3.9465581821337748`*^9},
 CellLabel->
  "In[229]:=",ExpressionUUID->"5c4a5128-1846-4400-b5e2-68b67b525d38"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"SMSInitialize", "[", 
    RowBox[{"\"\<SubproblemAceGenTest\>\"", ",", 
     RowBox[{"\"\<Language\>\"", "\[Rule]", "\"\<C\>\""}], ",", 
     RowBox[{"\"\<Mode\>\"", "->", "\"\<Optimal\>\""}]}], "]"}], ";"}], " ", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"SMSInitialize", "[", 
     RowBox[{"\"\<SubproblemAceGenTest\>\"", ",", 
      RowBox[{"\"\<Language\>\"", "\[Rule]", "\"\<C\>\""}], ",", 
      RowBox[{"\"\<Mode\>\"", "->", "\"\<Optimal\>\""}]}], "]"}], ";"}], " ", 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"n", "=", "2"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"SMSModule", "[", 
    RowBox[{"\"\<SubproblemAceGenTest\>\"", ",", 
     RowBox[{"Real", "[", 
      RowBox[{"solution$$", "[", "n", "]"}], "]"}]}], "]"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"fun", "[", "x_", "]"}], ":=", 
    RowBox[{"x", ".", "x"}]}], ";"}], " ", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"Example", " ", "quadratic", " ", "function", " ", "f", 
     RowBox[{"(", "x", ")"}]}], "=", 
    RowBox[{
     RowBox[{"x", "^", "T"}], " ", "x"}]}], "*)"}]}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"grad", "[", "x_", "]"}], ":=", 
    RowBox[{"2", " ", "x"}]}], ";"}], " ", 
  RowBox[{"(*", 
   RowBox[{"Gradient", " ", "of", " ", "f", 
    RowBox[{"(", "x", ")"}]}], "*)"}]}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"hess", "[", "x_", "]"}], ":=", 
    RowBox[{"2", " ", 
     RowBox[{"IdentityMatrix", "[", 
      RowBox[{"Length", "[", "x", "]"}], "]"}]}]}], ";"}], " ", 
  RowBox[{"(*", 
   RowBox[{"Hessian", " ", "of", " ", "f", 
    RowBox[{"(", "x", ")"}]}], "*)"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"x0", "\[DoubleRightTee]", 
    RowBox[{"SMSReal", "[", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"solution$$", "[", "i", "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "n"}], "}"}]}], "]"}], "]"}]}], ";"}], 
  RowBox[{"(*", 
   RowBox[{"Starting", " ", "point"}], "*)"}]}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"delta", "=", "0.01"}], ";"}], " ", 
  RowBox[{"(*", 
   RowBox[{"Initial", " ", "trust", " ", "region", " ", "radius"}], 
   "*)"}]}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"verbose", "=", "1"}], ";"}], " ", 
  RowBox[{"(*", 
   RowBox[{"Verbosity", " ", "level"}], "*)"}], "\[IndentingNewLine]", "\n", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"TrustRegion", "[", 
     RowBox[{
     "rosenbrock", ",", "rosenbrockGrad", ",", "rosenbrockHess", ",", "delta",
       ",", "x0", ",", "verbose"}], "]"}], ";"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"solution", "\[DoubleRightTee]", 
   RowBox[{"TrustRegion", "[", 
    RowBox[{
    "fun", ",", "grad", ",", "hess", ",", "delta", ",", "x0", ",", 
     "verbose"}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"SMSExport", "[", 
   RowBox[{"sol", ",", "solution$$"}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"SMSWrite", "[", 
   RowBox[{
    RowBox[{"\"\<IncludeHeaders\>\"", "->", 
     RowBox[{"{", "\"\<utilities.h\>\"", "}"}]}], ",", 
    RowBox[{"\"\<Splice\>\"", "->", 
     RowBox[{"{", 
      RowBox[{"\"\<subproblem.c\>\"", ",", " ", "\"\<utilities.c\>\""}], 
      "}"}]}]}], "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.944582395012553*^9, 3.9445824008847165`*^9}, {
   3.9445824327863197`*^9, 3.94458249360233*^9}, {3.944582591394967*^9, 
   3.9445826707381*^9}, {3.9445828626916385`*^9, 3.9445829920803623`*^9}, {
   3.9445830234749203`*^9, 3.944583023616292*^9}, {3.9445830721145554`*^9, 
   3.944583089008497*^9}, {3.944585458628723*^9, 3.944585572650257*^9}, {
   3.944585620322979*^9, 3.944585671684211*^9}, {3.9445860462699566`*^9, 
   3.944586052073522*^9}, {3.9445872219536963`*^9, 3.94458738647931*^9}, {
   3.9445874540791636`*^9, 3.9445874575660286`*^9}, {3.944588319080059*^9, 
   3.944588325189089*^9}, {3.944588539261174*^9, 3.9445885484766583`*^9}, {
   3.9445889419247684`*^9, 3.944588977475665*^9}, {3.9445894360276256`*^9, 
   3.9445894418260098`*^9}, {3.9445895289954185`*^9, 
   3.9445895342663774`*^9}, {3.9445895905472546`*^9, 3.94458959076863*^9}, 
   3.94458972596357*^9, {3.944590137939025*^9, 3.9445901567519865`*^9}, {
   3.9445902392416983`*^9, 3.944590249567762*^9}, {3.9445903209200954`*^9, 
   3.944590336311578*^9}, {3.9445903908264294`*^9, 3.944590422015356*^9}, {
   3.944591188278614*^9, 3.9445911941095533`*^9}, 3.944591715317357*^9, {
   3.9445918224610567`*^9, 3.9445918227721705`*^9}, {3.9447572037147903`*^9, 
   3.944757488584672*^9}, {3.9447575811212535`*^9, 3.9447575919133244`*^9}, 
   3.9447579046714993`*^9, {3.9447579850323253`*^9, 3.944758023766347*^9}, {
   3.944758342043431*^9, 3.944758403950558*^9}, {3.9447595987656918`*^9, 
   3.9447596001312156`*^9}, {3.9447602345647573`*^9, 
   3.9447602389630527`*^9}, {3.944760601876239*^9, 3.944760653273938*^9}, {
   3.9447607287629004`*^9, 3.9447607292534637`*^9}, {3.9447607966433434`*^9, 
   3.9447607973694515`*^9}, {3.946482340081848*^9, 3.946482366596211*^9}, {
   3.946482639793852*^9, 3.946482870217704*^9}, {3.946482967634367*^9, 
   3.9464831301372766`*^9}, {3.946483165780672*^9, 3.94648324171203*^9}, {
   3.94648343509971*^9, 3.946483537071636*^9}, {3.946483575759655*^9, 
   3.9464835809509172`*^9}, {3.946483611881505*^9, 3.9464836156468363`*^9}, {
   3.946483701222746*^9, 3.946483767279086*^9}, {3.946484287151932*^9, 
   3.946484326221816*^9}, {3.946484446656472*^9, 3.946484471854545*^9}, {
   3.946484857335958*^9, 3.946484880526752*^9}, {3.946485012207767*^9, 
   3.946485015139759*^9}, 3.946485093481909*^9, {3.946485804252454*^9, 
   3.946485839740264*^9}, {3.946486482183919*^9, 3.946486574374709*^9}, {
   3.946486644208784*^9, 3.946486654446877*^9}, {3.946486877386443*^9, 
   3.94648687830376*^9}, 3.946487003858149*^9, {3.9464870712899513`*^9, 
   3.946487124737178*^9}, {3.9464871760424137`*^9, 3.946487179289963*^9}, {
   3.9464872892541018`*^9, 3.9464873500519133`*^9}, {3.946487380269559*^9, 
   3.946487380899185*^9}, 3.9464874150194187`*^9, {3.94648783534308*^9, 
   3.946487906836109*^9}, {3.946488172145102*^9, 3.946488173766425*^9}, {
   3.946488237250154*^9, 3.946488245111073*^9}, {3.946488341546872*^9, 
   3.946488407647402*^9}, {3.94648848509734*^9, 3.946488515909651*^9}, {
   3.946488795341139*^9, 3.946488803108308*^9}, 3.946488853397708*^9, {
   3.946489810417493*^9, 3.946489829016287*^9}, {3.946490304358346*^9, 
   3.946490308724102*^9}, {3.946490352622755*^9, 3.946490358972327*^9}, {
   3.946490472306727*^9, 3.946490497352553*^9}, {3.946490816714511*^9, 
   3.946490875737713*^9}, {3.946491103187711*^9, 3.946491104496374*^9}, {
   3.9464911523399277`*^9, 3.946491153400877*^9}, 3.946545725468142*^9, {
   3.946547693093314*^9, 3.9465476992299147`*^9}, {3.946548471848366*^9, 
   3.946548493753489*^9}, {3.9465485878882523`*^9, 3.94654858964156*^9}, 
   3.9465581821337748`*^9, {3.946559193919379*^9, 3.946559208374893*^9}, {
   3.9465595683449306`*^9, 3.946559596014286*^9}, {3.946559680540257*^9, 
   3.9465597067661333`*^9}, {3.9465597719428043`*^9, 3.946559785606216*^9}, {
   3.946561220901621*^9, 3.946561222483467*^9}, {3.946562051171575*^9, 
   3.946562131651311*^9}, {3.946562318285864*^9, 3.946562324618657*^9}, {
   3.946563844091837*^9, 3.9465638557769823`*^9}, {3.9465744584954967`*^9, 
   3.946574460252626*^9}, {3.946574590141427*^9, 3.946574593852888*^9}, {
   3.946574733066743*^9, 3.946574750596258*^9}},
 CellLabel->
  "In[320]:=",ExpressionUUID->"bde6b50e-1de4-417a-96b9-97ba03a855da"],

Cell[BoxData[
 TagBox[GridBox[{
    {
     TemplateBox[{
       StyleBox["\"File: \"", Bold, 
        RGBColor[0, 0, 1], StripOnInput -> False], 
       "\"SubproblemAceGenTest.c\"", 
       StyleBox["\"  Size: \"", Bold, 
        RGBColor[0, 0, 1], StripOnInput -> False], "12997", 
       StyleBox["\"  Time: \"", Bold, 
        RGBColor[0, 0, 1], StripOnInput -> False], "2"},
      "RowDefault"]},
    {
     TagBox[GridBox[{
        {
         StyleBox["\<\"Method\"\>",
          StripOnInput->False,
          LineColor->RGBColor[0, 0, 1],
          FrontFaceColor->RGBColor[0, 0, 1],
          BackFaceColor->RGBColor[0, 0, 1],
          GraphicsColor->RGBColor[0, 0, 1],
          FontWeight->Bold,
          FontColor->RGBColor[0, 0, 1]], 
         StyleBox["\<\"SubproblemAceGenTest\"\>",
          StripOnInput->False,
          LineColor->RGBColor[0, 0, 1],
          FrontFaceColor->RGBColor[0, 0, 1],
          BackFaceColor->RGBColor[0, 0, 1],
          GraphicsColor->RGBColor[0, 0, 1],
          FontColor->RGBColor[0, 0, 1]]},
        {
         StyleBox["\<\"No.Formulae\"\>",
          StripOnInput->False,
          LineColor->RGBColor[0, 0, 1],
          FrontFaceColor->RGBColor[0, 0, 1],
          BackFaceColor->RGBColor[0, 0, 1],
          GraphicsColor->RGBColor[0, 0, 1],
          FontWeight->Bold,
          FontColor->RGBColor[0, 0, 1]], "40"},
        {
         StyleBox["\<\"No.Leafs\"\>",
          StripOnInput->False,
          LineColor->RGBColor[0, 0, 1],
          FrontFaceColor->RGBColor[0, 0, 1],
          BackFaceColor->RGBColor[0, 0, 1],
          GraphicsColor->RGBColor[0, 0, 1],
          FontWeight->Bold,
          FontColor->RGBColor[0, 0, 1]], "298"}
       },
       AutoDelete->False,
       GridBoxAlignment->{"Columns" -> {{Left}}, "Rows" -> {{Center}}},
       GridBoxDividers->{"Columns" -> {True, True}},
       GridBoxFrame->{"ColumnsIndexed" -> {{{1, -1}, {1, -1}} -> True}},
       GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
      "Grid"]}
   },
   DefaultBaseStyle->"Column",
   GridBoxAlignment->{"Columns" -> {{Left}}},
   GridBoxDividers->{"Rows" -> {True, True}},
   GridBoxFrame->{"Columns" -> False, "Rows" -> False},
   GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
  "Column"]], "Print",
 CellChangeTimes->{{3.94458566720887*^9, 3.944585673893199*^9}, 
   3.9445860549590435`*^9, 3.944587391406229*^9, 3.944587462361335*^9, 
   3.9445883364733095`*^9, 3.9445885606571627`*^9, 3.944588981174086*^9, 
   3.944589111869343*^9, 3.9445892255109463`*^9, 3.944589311798526*^9, 
   3.9445893524473987`*^9, 3.9445894491360083`*^9, 3.9445895447349358`*^9, 
   3.9445895985352287`*^9, {3.9445897299111304`*^9, 3.9445897393185215`*^9}, 
   3.9445901654320903`*^9, 3.944590344298279*^9, 3.9445904306984997`*^9, {
   3.9445911662271595`*^9, 3.94459119597519*^9}, 3.9445917199447203`*^9, 
   3.9445918314850035`*^9, {3.9447574474111733`*^9, 3.9447574930692043`*^9}, 
   3.944757601656103*^9, 3.9447580380886197`*^9, 3.9447584117181015`*^9, 
   3.944759611748519*^9, 3.944760241694913*^9, 3.944760613628791*^9, 
   3.9447606645802083`*^9, 3.944760732040681*^9, 3.944760799856638*^9, 
   3.9464832597793503`*^9, 3.9464835423003817`*^9, 3.946483583776991*^9, 
   3.946483617310557*^9, {3.946483711895604*^9, 3.946483725283203*^9}, 
   3.946483768854479*^9, {3.946484302269731*^9, 3.946484328146948*^9}, {
   3.946484450984624*^9, 3.946484462955461*^9}, {3.9464848459991198`*^9, 
   3.94648488303067*^9}, 3.946484972415428*^9, {3.946485021132452*^9, 
   3.9464850408584433`*^9}, 3.946485113000145*^9, {3.9464855733101788`*^9, 
   3.946485586021407*^9}, 3.946485662261731*^9, 3.946485704404513*^9, 
   3.946485799041788*^9, 3.946485842173436*^9, 3.946485974574871*^9, 
   3.946486090851879*^9, 3.946486324311335*^9, {3.9464864858058033`*^9, 
   3.946486511988669*^9}, 3.9464865763630342`*^9, {3.9464866481666813`*^9, 
   3.946486656046468*^9}, 3.946486841020321*^9, 3.946486880563271*^9, {
   3.946486935329343*^9, 3.946486941724725*^9}, {3.9464869993672867`*^9, 
   3.94648700576331*^9}, {3.946487077494405*^9, 3.9464871266538754`*^9}, 
   3.9464871807797194`*^9, {3.946487317035863*^9, 3.946487356021317*^9}, 
   3.946487418907669*^9, 3.946487614128023*^9, 3.946487781856752*^9, {
   3.9464878378788023`*^9, 3.946487862341671*^9}, 3.946487926780674*^9, 
   3.946488175416217*^9, 3.946488246397908*^9, {3.946488372992395*^9, 
   3.946488410669819*^9}, 3.946488517699201*^9, {3.9464888365288057`*^9, 
   3.946488855042178*^9}, 3.946489243093528*^9, 3.946489281603278*^9, 
   3.946489479760756*^9, 3.946489520142211*^9, 3.946489651806284*^9, 
   3.94648972125696*^9, 3.946489762530616*^9, 3.946489835165392*^9, 
   3.946490197712762*^9, 3.946490249217182*^9, 3.946490310688428*^9, 
   3.946490361975287*^9, {3.946490480257773*^9, 3.9464904986340647`*^9}, 
   3.94649055168677*^9, {3.946490857654106*^9, 3.946490878174404*^9}, 
   3.946491048121232*^9, 3.9464911073444242`*^9, 3.946491155757189*^9, 
   3.946546809399185*^9, 3.946546879998178*^9, 3.946547181072674*^9, 
   3.946547276801724*^9, 3.9465474445027027`*^9, 3.946547503338316*^9, 
   3.946547543979398*^9, 3.9465477066799192`*^9, 3.94654851073906*^9, 
   3.946548592452586*^9, 3.946559227018814*^9, 3.9465593255793858`*^9, {
   3.946559579064109*^9, 3.9465596031191387`*^9}, 3.946559845337697*^9, 
   3.9465600525610743`*^9, {3.9465603331776876`*^9, 3.946560360384881*^9}, 
   3.946560696770886*^9, 3.946560796851797*^9, 3.946560942318919*^9, 
   3.946561227511701*^9, 3.9465616666663094`*^9, 3.946561995033804*^9, 
   3.946562142938479*^9, 3.946562282565213*^9, 3.946562328334594*^9, 
   3.946563862912401*^9, 3.9465653045713997`*^9, 3.946574136562553*^9, {
   3.946574449309031*^9, 3.946574462284575*^9}, 3.946574602480349*^9, {
   3.946574751868677*^9, 3.946574770816296*^9}, 3.946574905284305*^9, 
   3.946574977455681*^9},
 CellLabel->
  "During evaluation of \
In[320]:=",ExpressionUUID->"d7cb136b-fe6b-40e5-b6e9-12a878461702"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"<<", "\"\<SubproblemAceGenTest.m\>\""}], "\n", 
 RowBox[{
  RowBox[{"SMSLoadSession", "[", "\"\<SubproblemAceGenTest\>\"", "]"}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.893155820578499*^9, 3.893155821573756*^9}, {
  3.94656017508711*^9, 3.946560176878611*^9}},
 CellLabel->"In[31]:=",ExpressionUUID->"66529357-c463-4aac-a63a-fb6db1d7c0eb"],

Cell["\<\
Syntax::sntx: Invalid syntax in or before \"// subproblem function\". (line \
16 of \"SubproblemAceGenTest.m\")
                                             ^\
\>", "Message", "MSG",
 CellChangeTimes->{3.9465601796095257`*^9},
 CellLabel->
  "During evaluation of \
In[31]:=",ExpressionUUID->"8f64bb57-0244-4c5d-9f34-af69a65bb418"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"SMSInstallMathLink", "[", 
  RowBox[{"\"\<SubproblemAceGenTest\>\"", ",", 
   RowBox[{"\"\<Console\>\"", "->", "True"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.9464851508909273`*^9, 3.946485155951614*^9}, {
   3.9464856982317247`*^9, 3.9464856994189663`*^9}, 3.946486490326831*^9, {
   3.946486992680133*^9, 3.946486996586924*^9}, {3.946558331093111*^9, 
   3.9465583646122704`*^9}},
 CellLabel->
  "In[157]:=",ExpressionUUID->"e6351e52-d936-4b24-a9de-7b6a6a19b663"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   TagBox[
    RowBox[{"SMSSetLinkOption", "[", 
     RowBox[{"\<\"SubproblemAceGenTest\"\>", ",", 
      RowBox[{"{", 
       RowBox[{"i_Integer", ",", "j_Integer"}], "}"}]}], "]"}],
    HoldForm], ",", 
   TagBox[
    RowBox[{"SMSLinkNoEvaluations", "[", "\<\"SubproblemAceGenTest\"\>", "]"}],
    HoldForm], ",", 
   TagBox[
    RowBox[{"SubproblemAceGenTest", "[", 
     RowBox[{"solution_", "?", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"ArrayQ", "[", 
          RowBox[{"#1", ",", "1", ",", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"Head", "[", "#1", "]"}], "\[Equal]", "Real"}], "||", 
             RowBox[{
              RowBox[{"Head", "[", "#1", "]"}], "\[Equal]", "Integer"}]}], 
            "&"}]}], "]"}], "&&", 
         RowBox[{
          RowBox[{"Dimensions", "[", "#1", "]"}], "===", 
          RowBox[{"{", "2", "}"}]}]}], "&"}], ")"}]}], "]"}],
    HoldForm]}], "}"}]], "Output",
 CellChangeTimes->{
  3.9445890800824175`*^9, 3.9445891548323936`*^9, 3.944589310817481*^9, 
   3.9445894461207623`*^9, 3.94458953883762*^9, {3.9445895940534563`*^9, 
   3.9445896065844693`*^9}, 3.9445897460435853`*^9, 3.9445898734074545`*^9, 
   3.94459017619863*^9, 3.9445903523386154`*^9, 3.944590437579979*^9, 
   3.944591171145282*^9, 3.946485030887744*^9, 3.946485157947221*^9, {
   3.946485575755114*^9, 3.9464855899337187`*^9}, 3.946485665535763*^9, {
   3.94648570083011*^9, 3.946485706039772*^9}, 3.94648580115936*^9, 
   3.94648584413938*^9, 3.946485978073834*^9, 3.94648609364375*^9, 
   3.9464863353132877`*^9, {3.946486492732561*^9, 3.946486514015867*^9}, 
   3.946486580688645*^9, 3.946486658975609*^9, 3.9464868432784452`*^9, 
   3.9464868830924377`*^9, {3.946486937423141*^9, 3.9464869442296677`*^9}, {
   3.946487001566353*^9, 3.946487009281196*^9}, {3.94648710467247*^9, 
   3.946487129105879*^9}, 3.9464871838878593`*^9, {3.946487320035198*^9, 
   3.9464873590887527`*^9}, 3.946487421434359*^9, 3.9464876172921352`*^9, 
   3.946487784265923*^9, {3.946487841644668*^9, 3.946487865495576*^9}, 
   3.946487931491787*^9, 3.946488179783915*^9, 3.9464882519609737`*^9, {
   3.9464883769211397`*^9, 3.9464884142225018`*^9}, 3.9464885223296328`*^9, {
   3.946488840260323*^9, 3.9464888572090197`*^9}, 3.946488894452127*^9, 
   3.94648924699973*^9, 3.946489284191044*^9, 3.946489481752924*^9, 
   3.9464895222236*^9, 3.946489655135803*^9, 3.946489722985387*^9, 
   3.946489764869535*^9, 3.946490365147394*^9, {3.946490482838114*^9, 
   3.946490502515791*^9}, 3.946490554435337*^9, 3.9464910514967833`*^9, 
   3.946491114273307*^9, 3.946491161006543*^9, 3.9465477113100367`*^9, 
   3.946548516570466*^9, 3.9465485962633047`*^9, {3.946558340175748*^9, 
   3.946558365563363*^9}, 3.946559612776732*^9, 3.94655985582664*^9, 
   3.9465599777852583`*^9, 3.946560058566016*^9, 3.9465608025100727`*^9, {
   3.946560950382083*^9, 3.94656096471756*^9}, 3.9465612361125603`*^9, 
   3.94656167619271*^9, 3.94656201506962*^9, 3.946562151075069*^9, 
   3.9465622897163143`*^9},
 CellLabel->
  "Out[157]=",ExpressionUUID->"1beb13af-2bcb-4241-aeee-91e10a613b47"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"wynik", "=", 
  RowBox[{"SubproblemAceGenTest", "[", 
   RowBox[{"{", 
    RowBox[{"10000.2", ",", "1000.2"}], "}"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.9464879967575493`*^9, 3.946487996843725*^9}, {
   3.946488092925734*^9, 3.9464881394536467`*^9}, {3.9464882770715437`*^9, 
   3.946488282607798*^9}, {3.946547726904228*^9, 3.946547737415663*^9}, {
   3.9465598708308067`*^9, 3.946559882188877*^9}, {3.946560066358405*^9, 
   3.94656010938269*^9}, {3.946560813603545*^9, 3.946560836395156*^9}, {
   3.946562159021884*^9, 3.9465621815381203`*^9}, 3.946562293602646*^9},
 CellLabel->
  "In[160]:=",ExpressionUUID->"6d88ac9e-8175-471b-8759-4eda14ff303f"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"2050.9458910665485`", ",", "205.13150539436856`"}], 
  "}"}]], "Output",
 CellChangeTimes->{
  3.946488284449422*^9, {3.946488381069251*^9, 3.946488418137946*^9}, 
   3.94648852659702*^9, 3.9464888991297693`*^9, 3.9464910866292562`*^9, 
   3.946491118598399*^9, 3.9464911672417917`*^9, 3.946491837687388*^9, 
   3.946547739160246*^9, 3.946548521145632*^9, 3.946548599959517*^9, 
   3.946558377151335*^9, {3.946559239570036*^9, 3.9465592595273037`*^9}, 
   3.946559620713993*^9, {3.946559862510316*^9, 3.9465598833402233`*^9}, 
   3.946559982250607*^9, {3.946560061947687*^9, 3.946560110482785*^9}, {
   3.9465608072683487`*^9, 3.946560837360209*^9}, {3.946560958534336*^9, 
   3.946560968224751*^9}, 3.9465612397118196`*^9, 3.946561678785872*^9, 
   3.946562017631476*^9, {3.9465621562412643`*^9, 3.9465621824011593`*^9}, {
   3.946562291950254*^9, 3.946562297699572*^9}},
 CellLabel->
  "Out[160]=",ExpressionUUID->"3f466d7e-1e03-4d89-869f-2ecb9b10ddf4"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"SMSUninstallMathLink", "[", "]"}], ";"}]], "Input",
 CellLabel->
  "In[116]:=",ExpressionUUID->"ec206e4a-d101-4104-ac7f-8a1ce9f37e51"]
},
WindowSize->{1283.25, 743.25},
WindowMargins->{{-2.25, Automatic}, {Automatic, -22.5}},
FrontEndVersion->"14.1 for Linux x86 (64-bit) (July 16, 2024)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"fcbe0d31-3f4a-41ab-b734-6e96c1dc1c77"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 213, 3, 29, "Input",ExpressionUUID->"927a0af1-6d07-4841-a4de-3ec128879900"],
Cell[796, 27, 404, 6, 33, "Output",ExpressionUUID->"fc3499e5-9f96-4a51-956a-ccf309f64150"]
}, Open  ]],
Cell[CellGroupData[{
Cell[1237, 38, 252, 4, 29, "Input",ExpressionUUID->"7c76c145-1f51-40ec-87db-d42ea99550cc"],
Cell[1492, 44, 406, 6, 33, "Output",ExpressionUUID->"bdb8f08d-00f1-47cc-9784-2030c28daa65"]
}, Open  ]],
Cell[1913, 53, 9816, 199, 1211, "Input",ExpressionUUID->"d232c276-3a17-4009-913c-0d0c062189cb"],
Cell[CellGroupData[{
Cell[11754, 256, 265, 6, 29, "Input",ExpressionUUID->"ec95ed9e-ff0c-4551-b654-1434a7d7b059"],
Cell[12022, 264, 425, 13, 34, "Output",ExpressionUUID->"ac164716-b349-4f6a-a802-9ec3c5bcc522"]
}, Open  ]],
Cell[CellGroupData[{
Cell[12484, 282, 377, 9, 29, "Input",ExpressionUUID->"f36e14c8-3f7a-42da-809e-d6a0d4e982ea"],
Cell[12864, 293, 275, 6, 33, "Output",ExpressionUUID->"02d470cf-a34f-47af-a940-6027f5cdb4eb"]
}, Open  ]],
Cell[CellGroupData[{
Cell[13176, 304, 179, 3, 29, "Input",ExpressionUUID->"809862d6-3841-434c-8020-b9fa23161e55"],
Cell[13358, 309, 202, 5, 33, "Output",ExpressionUUID->"37a0db9a-3980-4559-8127-8bb55d4803af"]
}, Open  ]],
Cell[CellGroupData[{
Cell[13597, 319, 304, 7, 29, "Input",ExpressionUUID->"6c20ee66-23ff-41e8-9ff1-5dce664d7cf4"],
Cell[13904, 328, 937, 27, 67, "Output",ExpressionUUID->"7f69582a-30b7-4b0e-b5d8-02010b5db66c"]
}, Open  ]],
Cell[14856, 358, 5848, 164, 369, "Input",ExpressionUUID->"b9a07afc-9bc0-4c84-81b4-8a1d9d5ee6ad"],
Cell[20707, 524, 3780, 54, 29, "Input",ExpressionUUID->"5c4a5128-1846-4400-b5e2-68b67b525d38"],
Cell[CellGroupData[{
Cell[24512, 582, 7646, 159, 351, "Input",ExpressionUUID->"bde6b50e-1de4-417a-96b9-97ba03a855da"],
Cell[32161, 743, 6002, 114, 81, "Print",ExpressionUUID->"d7cb136b-fe6b-40e5-b6e9-12a878461702"]
}, Open  ]],
Cell[CellGroupData[{
Cell[38200, 862, 368, 7, 49, "Input",ExpressionUUID->"66529357-c463-4aac-a63a-fb6db1d7c0eb"],
Cell[38571, 871, 341, 8, 38, "Message",ExpressionUUID->"8f64bb57-0244-4c5d-9f34-af69a65bb418"]
}, Open  ]],
Cell[CellGroupData[{
Cell[38949, 884, 492, 9, 29, "Input",ExpressionUUID->"e6351e52-d936-4b24-a9de-7b6a6a19b663"],
Cell[39444, 895, 3171, 62, 53, "Output",ExpressionUUID->"1beb13af-2bcb-4241-aeee-91e10a613b47"]
}, Open  ]],
Cell[CellGroupData[{
Cell[42652, 962, 682, 12, 29, "Input",ExpressionUUID->"6d88ac9e-8175-471b-8759-4eda14ff303f"],
Cell[43337, 976, 995, 17, 33, "Output",ExpressionUUID->"3f466d7e-1e03-4d89-869f-2ecb9b10ddf4"]
}, Open  ]],
Cell[44347, 996, 169, 4, 29, "Input",ExpressionUUID->"ec206e4a-d101-4104-ac7f-8a1ce9f37e51"]
}
]
*)

